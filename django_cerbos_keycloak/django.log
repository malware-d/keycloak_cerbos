INFO 2025-08-06 03:07:31,781 autoreload 61811 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:07:45,108 basehttp 61811 123145433518080 "GET / HTTP/1.1" 200 941
WARNING 2025-08-06 03:07:45,474 log 61811 123145433518080 Not Found: /favicon.ico
WARNING 2025-08-06 03:07:45,475 basehttp 61811 123145433518080 "GET /favicon.ico HTTP/1.1" 404 2728
INFO 2025-08-06 03:07:47,149 basehttp 61811 123145433518080 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-06 03:07:48,820 basehttp 61811 123145433518080 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 03:07:53,118 basehttp 61811 123145433518080 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 03:08:38,625 basehttp 61811 123145433518080 "GET /accounts/oidc/keycloak/login/callback/?state=28CqWkBJBwUGwrQS&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=4e01259f-53f7-4213-b958-26fc306fafdb.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 03:08:38,641 basehttp 61811 123145433518080 "GET /documents/ HTTP/1.1" 200 2039
ERROR 2025-08-06 03:08:43,246 log 61811 123145433518080 Internal Server Error: /document/doc123/view/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 43, in manage_document
    if not cerbos_client.is_allowed(action, principal, resource):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/cerbos/sdk/_sync/_http.py", line 207, in is_allowed
    resp = self.check_resources(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/cerbos/sdk/_sync/_http.py", line 176, in check_resources
    resp = self._http.post(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/cerbos/sdk/_sync/_http.py", line 37, in post
    return self._post_fn(*args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_client.py", line 1144, in post
    return self.request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_client.py", line 812, in request
    request = self.build_request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_client.py", line 378, in build_request
    return Request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_models.py", line 408, in __init__
    headers, stream = encode_request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_content.py", line 216, in encode_request
    return encode_json(json)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_content.py", line 177, in encode_json
    body = json_dumps(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 234, in dumps
    return cls(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Principal is not JSON serializable
ERROR 2025-08-06 03:08:43,281 basehttp 61811 123145433518080 "GET /document/doc123/view/ HTTP/1.1" 500 151559
ERROR 2025-08-06 03:08:47,961 log 61811 123145433518080 Internal Server Error: /document/doc123/edit/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 43, in manage_document
    if not cerbos_client.is_allowed(action, principal, resource):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/cerbos/sdk/_sync/_http.py", line 207, in is_allowed
    resp = self.check_resources(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/cerbos/sdk/_sync/_http.py", line 176, in check_resources
    resp = self._http.post(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/cerbos/sdk/_sync/_http.py", line 37, in post
    return self._post_fn(*args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_client.py", line 1144, in post
    return self.request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_client.py", line 812, in request
    request = self.build_request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_client.py", line 378, in build_request
    return Request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_models.py", line 408, in __init__
    headers, stream = encode_request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_content.py", line 216, in encode_request
    return encode_json(json)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_content.py", line 177, in encode_json
    body = json_dumps(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 234, in dumps
    return cls(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Principal is not JSON serializable
ERROR 2025-08-06 03:08:47,979 basehttp 61811 123145433518080 "GET /document/doc123/edit/ HTTP/1.1" 500 151559
ERROR 2025-08-06 03:10:46,357 log 61811 123145433518080 Internal Server Error: /document/doc123/view/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 43, in manage_document
    if not cerbos_client.is_allowed(action, principal, resource):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/cerbos/sdk/_sync/_http.py", line 207, in is_allowed
    resp = self.check_resources(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/cerbos/sdk/_sync/_http.py", line 176, in check_resources
    resp = self._http.post(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/cerbos/sdk/_sync/_http.py", line 37, in post
    return self._post_fn(*args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_client.py", line 1144, in post
    return self.request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_client.py", line 812, in request
    request = self.build_request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_client.py", line 378, in build_request
    return Request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_models.py", line 408, in __init__
    headers, stream = encode_request(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_content.py", line 216, in encode_request
    return encode_json(json)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/httpx/_content.py", line 177, in encode_json
    body = json_dumps(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/__init__.py", line 234, in dumps
    return cls(
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type Principal is not JSON serializable
ERROR 2025-08-06 03:10:46,369 basehttp 61811 123145433518080 "GET /document/doc123/view/ HTTP/1.1" 500 151559
INFO 2025-08-06 03:13:51,068 autoreload 61811 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:13:53,148 autoreload 62010 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:14:08,160 autoreload 62010 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 03:14:09,989 autoreload 62023 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:15:49,881 autoreload 62090 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:15:54,054 views 62090 123145405808640 User john_doe attempting view on document doc123 with roles: []
ERROR 2025-08-06 03:15:54,057 views 62090 123145405808640 Cerbos authorization error: Object of type Principal is not JSON serializable
WARNING 2025-08-06 03:15:54,063 log 62090 123145405808640 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:15:54,064 basehttp 62090 123145405808640 "GET /document/doc123/view/ HTTP/1.1" 403 58
INFO 2025-08-06 03:15:58,934 basehttp 62090 123145405808640 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 03:16:00,654 basehttp 62090 123145405808640 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 03:16:00,661 basehttp 62090 123145405808640 "GET / HTTP/1.1" 200 1217
INFO 2025-08-06 03:16:02,027 basehttp 62090 123145405808640 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 03:16:03,282 basehttp 62090 123145405808640 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 03:16:04,216 basehttp 62090 123145405808640 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 03:16:04,508 basehttp 62090 123145405808640 "GET /accounts/oidc/keycloak/login/callback/?state=dx1ijwtxFZj5Yq6M&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=a32196e8-09fa-4e2b-800c-c959529114e7.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 03:16:04,522 basehttp 62090 123145405808640 "GET /documents/ HTTP/1.1" 200 3021
INFO 2025-08-06 03:16:06,075 basehttp 62090 123145405808640 "GET /documents/ HTTP/1.1" 200 3021
INFO 2025-08-06 03:16:07,261 basehttp 62090 123145405808640 "GET /documents/ HTTP/1.1" 200 3021
INFO 2025-08-06 03:16:08,157 basehttp 62090 123145405808640 "GET /check-permissions/ HTTP/1.1" 200 446
INFO 2025-08-06 03:16:19,646 views 62090 123145405808640 User john_doe attempting delete on document doc123 with roles: []
ERROR 2025-08-06 03:16:19,649 views 62090 123145405808640 Cerbos authorization error: Object of type Principal is not JSON serializable
WARNING 2025-08-06 03:16:19,657 log 62090 123145405808640 Forbidden: /document/doc123/delete/
WARNING 2025-08-06 03:16:19,658 basehttp 62090 123145405808640 "GET /document/doc123/delete/ HTTP/1.1" 403 58
INFO 2025-08-06 03:17:55,485 autoreload 62090 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:17:57,478 autoreload 62175 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:18:06,363 autoreload 62175 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-06 03:18:07,970 autoreload 62187 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:18:27,032 autoreload 62200 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:20:25,773 autoreload 62200 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:20:28,004 autoreload 62263 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:20:34,508 utils 62263 123145604382720 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:20:34,508 utils 62263 123145604382720 Extracted roles for user john_doe: []
INFO 2025-08-06 03:20:34,509 views 62263 123145604382720 Checking delete on doc123 for john_doe with roles []
ERROR 2025-08-06 03:20:34,509 views 62263 123145604382720 Cerbos error: Resource
WARNING 2025-08-06 03:20:34,513 log 62263 123145604382720 Forbidden: /document/doc123/delete/
WARNING 2025-08-06 03:20:34,514 basehttp 62263 123145604382720 "GET /document/doc123/delete/ HTTP/1.1" 403 34
INFO 2025-08-06 03:20:47,850 basehttp 62263 123145604382720 "GET / HTTP/1.1" 200 3021
INFO 2025-08-06 03:20:48,785 basehttp 62263 123145604382720 "GET /documents/ HTTP/1.1" 200 3021
INFO 2025-08-06 03:20:50,312 utils 62263 123145604382720 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:20:50,313 utils 62263 123145604382720 Extracted roles for user john_doe: []
INFO 2025-08-06 03:20:50,313 views 62263 123145604382720 Checking view on doc123 for john_doe with roles []
ERROR 2025-08-06 03:20:50,314 views 62263 123145604382720 Cerbos error: Resource
WARNING 2025-08-06 03:20:50,317 log 62263 123145604382720 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:20:50,319 basehttp 62263 123145604382720 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:20:55,467 utils 62263 123145604382720 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:20:55,470 utils 62263 123145604382720 Extracted roles for user john_doe: []
INFO 2025-08-06 03:20:55,470 views 62263 123145604382720 Checking edit on doc123 for john_doe with roles []
ERROR 2025-08-06 03:20:55,470 views 62263 123145604382720 Cerbos error: Resource
WARNING 2025-08-06 03:20:55,481 log 62263 123145604382720 Forbidden: /document/doc123/edit/
WARNING 2025-08-06 03:20:55,483 basehttp 62263 123145604382720 "GET /document/doc123/edit/ HTTP/1.1" 403 34
INFO 2025-08-06 03:22:29,569 autoreload 62263 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:22:31,924 autoreload 62345 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:22:36,954 autoreload 62345 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/cerbos_client.py changed, reloading.
INFO 2025-08-06 03:22:38,059 autoreload 62353 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:22:54,581 autoreload 62367 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:23:30,021 autoreload 62367 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 03:23:30,798 autoreload 62390 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:23:51,646 autoreload 62390 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 03:23:53,376 autoreload 62404 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:24:14,833 utils 62404 123145348595712 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:24:14,834 utils 62404 123145348595712 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:24:14,837 log 62404 123145348595712 Forbidden: /document/doc123/edit/
WARNING 2025-08-06 03:24:14,838 basehttp 62404 123145348595712 "GET /document/doc123/edit/ HTTP/1.1" 403 34
ERROR 2025-08-06 03:24:19,119 log 62404 123145348595712 Internal Server Error: /
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 11, in home
    return render(request, 'documents/home.html')
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 61, in render
    return self.template.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 175, in render
    return self._render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 167, in _render
    return self.nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 321, in render
    return nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'document_list' not found. 'document_list' is not a valid view function or pattern name.
ERROR 2025-08-06 03:24:19,138 basehttp 62404 123145348595712 "GET / HTTP/1.1" 500 148270
ERROR 2025-08-06 03:24:21,308 log 62404 123145348595712 Internal Server Error: /
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 11, in home
    return render(request, 'documents/home.html')
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 61, in render
    return self.template.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 175, in render
    return self._render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 167, in _render
    return self.nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 321, in render
    return nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'document_list' not found. 'document_list' is not a valid view function or pattern name.
ERROR 2025-08-06 03:24:21,309 basehttp 62404 123145348595712 "GET / HTTP/1.1" 500 148270
ERROR 2025-08-06 03:24:30,886 log 62404 123145348595712 Internal Server Error: /documents/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 11, in home
    return render(request, 'documents/home.html')
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 61, in render
    return self.template.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 175, in render
    return self._render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 167, in _render
    return self.nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 321, in render
    return nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'document_list' not found. 'document_list' is not a valid view function or pattern name.
ERROR 2025-08-06 03:24:30,887 basehttp 62404 123145348595712 "GET /documents/ HTTP/1.1" 500 148400
ERROR 2025-08-06 03:24:36,406 log 62404 123145348595712 Internal Server Error: /
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 11, in home
    return render(request, 'documents/home.html')
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 61, in render
    return self.template.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 175, in render
    return self._render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 167, in _render
    return self.nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 321, in render
    return nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'document_list' not found. 'document_list' is not a valid view function or pattern name.
ERROR 2025-08-06 03:24:36,438 basehttp 62404 123145348595712 "GET / HTTP/1.1" 500 148270
INFO 2025-08-06 03:25:09,708 autoreload 62404 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:25:11,911 autoreload 62455 140704330349056 Watching for file changes with StatReloader
ERROR 2025-08-06 03:25:16,639 log 62455 123145419595776 Internal Server Error: /
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 12, in home
    return render(request, 'documents/home.html')
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 61, in render
    return self.template.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 175, in render
    return self._render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 167, in _render
    return self.nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 321, in render
    return nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'document_list' not found. 'document_list' is not a valid view function or pattern name.
ERROR 2025-08-06 03:25:16,655 basehttp 62455 123145419595776 "GET / HTTP/1.1" 500 148287
INFO 2025-08-06 03:25:36,548 basehttp 62455 123145419595776 "GET / HTTP/1.1" 200 1217
INFO 2025-08-06 03:25:38,159 basehttp 62455 123145419595776 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-06 03:25:39,765 basehttp 62455 123145419595776 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 03:25:41,709 basehttp 62455 123145419595776 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 03:25:41,997 basehttp 62455 123145419595776 "GET /accounts/oidc/keycloak/login/callback/?state=GjCFbcVWrsFKCLAh&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=dd2bc1d3-5d48-4727-a2cb-70005739c0c7.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
ERROR 2025-08-06 03:25:42,069 log 62455 123145419595776 Internal Server Error: /documents/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 12, in home
    return render(request, 'documents/home.html')
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 61, in render
    return self.template.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 175, in render
    return self._render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 167, in _render
    return self.nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 321, in render
    return nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'document_list' not found. 'document_list' is not a valid view function or pattern name.
ERROR 2025-08-06 03:25:42,070 basehttp 62455 123145419595776 "GET /documents/ HTTP/1.1" 500 148560
INFO 2025-08-06 03:26:07,118 basehttp 62455 123145419595776 "GET /documents/ HTTP/1.1" 200 2039
INFO 2025-08-06 03:26:31,382 autoreload 62455 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:26:33,585 autoreload 62512 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:26:35,763 basehttp 62512 123145585569792 "GET /documents/ HTTP/1.1" 200 2039
INFO 2025-08-06 03:26:37,141 utils 62512 123145585569792 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:26:37,142 utils 62512 123145585569792 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:26:37,149 log 62512 123145585569792 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:26:37,149 basehttp 62512 123145585569792 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:26:39,769 utils 62512 123145585569792 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:26:39,769 utils 62512 123145585569792 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:26:39,775 log 62512 123145585569792 Forbidden: /document/doc123/edit/
WARNING 2025-08-06 03:26:39,776 basehttp 62512 123145585569792 "GET /document/doc123/edit/ HTTP/1.1" 403 34
INFO 2025-08-06 03:26:43,914 utils 62512 123145585569792 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:26:43,915 utils 62512 123145585569792 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:26:43,918 log 62512 123145585569792 Forbidden: /document/doc123/approve/
WARNING 2025-08-06 03:26:43,918 basehttp 62512 123145585569792 "GET /document/doc123/approve/ HTTP/1.1" 403 34
INFO 2025-08-06 03:27:49,169 autoreload 62512 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:27:52,267 autoreload 62559 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:29:16,809 basehttp 62559 123145515880448 "GET /documents/ HTTP/1.1" 200 2039
INFO 2025-08-06 03:29:17,887 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:29:17,887 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:29:18,154 log 62559 123145515880448 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:29:18,155 basehttp 62559 123145515880448 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:29:20,247 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:29:20,247 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:29:20,252 log 62559 123145515880448 Forbidden: /document/doc123/edit/
WARNING 2025-08-06 03:29:20,252 basehttp 62559 123145515880448 "GET /document/doc123/edit/ HTTP/1.1" 403 34
INFO 2025-08-06 03:29:21,888 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:29:21,888 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:29:21,893 log 62559 123145515880448 Forbidden: /document/doc123/delete/
WARNING 2025-08-06 03:29:21,894 basehttp 62559 123145515880448 "GET /document/doc123/delete/ HTTP/1.1" 403 34
INFO 2025-08-06 03:29:23,636 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:29:23,636 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:29:23,640 log 62559 123145515880448 Forbidden: /document/doc123/approve/
WARNING 2025-08-06 03:29:23,640 basehttp 62559 123145515880448 "GET /document/doc123/approve/ HTTP/1.1" 403 34
INFO 2025-08-06 03:31:51,604 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:31:51,605 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:31:51,611 log 62559 123145515880448 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:31:51,612 basehttp 62559 123145515880448 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:40:34,655 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:40:34,657 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:40:34,667 log 62559 123145515880448 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:40:34,667 basehttp 62559 123145515880448 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:40:35,656 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:40:35,658 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:40:35,663 log 62559 123145515880448 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:40:35,664 basehttp 62559 123145515880448 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:40:36,373 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:40:36,373 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:40:36,378 log 62559 123145515880448 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:40:36,378 basehttp 62559 123145515880448 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:40:38,654 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:40:38,654 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:40:38,657 log 62559 123145515880448 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:40:38,657 basehttp 62559 123145515880448 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:40:44,017 basehttp 62559 123145515880448 "GET / HTTP/1.1" 200 2039
INFO 2025-08-06 03:40:45,740 utils 62559 123145515880448 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:40:45,741 utils 62559 123145515880448 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:40:45,749 log 62559 123145515880448 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:40:45,750 basehttp 62559 123145515880448 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:44:21,036 autoreload 62559 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:44:23,009 autoreload 63865 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:44:54,106 autoreload 63865 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:44:55,946 autoreload 63883 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:45:01,761 utils 63883 123145365463040 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:45:01,761 utils 63883 123145365463040 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:45:01,766 log 63883 123145365463040 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:45:01,767 basehttp 63883 123145365463040 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:45:02,811 utils 63883 123145365463040 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:45:02,811 utils 63883 123145365463040 Extracted roles for user john_doe: []
WARNING 2025-08-06 03:45:02,816 log 63883 123145365463040 Forbidden: /document/doc123/view/
WARNING 2025-08-06 03:45:02,818 basehttp 63883 123145365463040 "GET /document/doc123/view/ HTTP/1.1" 403 34
INFO 2025-08-06 03:46:57,822 autoreload 63883 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/cerbos_client.py changed, reloading.
INFO 2025-08-06 03:47:00,762 autoreload 63978 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:47:14,166 autoreload 63978 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:47:15,847 autoreload 63991 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:48:02,882 autoreload 63991 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:48:04,240 autoreload 64015 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:49:55,491 autoreload 64015 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:49:57,587 autoreload 64105 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:51:07,785 autoreload 64105 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 03:51:09,601 autoreload 64173 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:51:27,977 autoreload 64173 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 03:51:28,807 autoreload 64187 140704330349056 Watching for file changes with StatReloader
WARNING 2025-08-06 03:51:31,587 log 64187 123145570668544 Not Found: /document/doc123/view/
WARNING 2025-08-06 03:51:31,588 basehttp 64187 123145570668544 "GET /document/doc123/view/ HTTP/1.1" 404 2749
INFO 2025-08-06 03:51:37,718 basehttp 64187 123145570668544 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 03:51:38,740 basehttp 64187 123145570668544 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 03:51:38,746 basehttp 64187 123145570668544 "GET / HTTP/1.1" 200 941
INFO 2025-08-06 03:51:39,803 basehttp 64187 123145570668544 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 03:51:41,615 basehttp 64187 123145570668544 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 03:51:45,231 basehttp 64187 123145570668544 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 03:51:46,405 basehttp 64187 123145570668544 "GET /accounts/oidc/keycloak/login/callback/?state=wgGeWUCZQvZvRbSo&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=f872a8c9-705d-4a2b-b805-51bc99a2ef92.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 03:51:46,421 basehttp 64187 123145570668544 "GET /documents/ HTTP/1.1" 200 2003
INFO 2025-08-06 03:51:47,943 utils 64187 123145570668544 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:51:47,943 utils 64187 123145570668544 Extracted roles for user john_doe: []
INFO 2025-08-06 03:51:48,787 _client 64187 123145570668544 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 03:51:48,791 basehttp 64187 123145570668544 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 03:51:54,157 utils 64187 123145570668544 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:51:54,158 utils 64187 123145570668544 Extracted roles for user john_doe: []
INFO 2025-08-06 03:51:54,178 _client 64187 123145570668544 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 03:51:54,185 basehttp 64187 123145570668544 "GET /doc123/edit/ HTTP/1.1" 200 33
INFO 2025-08-06 03:51:58,061 utils 64187 123145570668544 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:51:58,062 utils 64187 123145570668544 Extracted roles for user john_doe: []
INFO 2025-08-06 03:51:58,072 _client 64187 123145570668544 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 03:51:58,078 log 64187 123145570668544 Forbidden: /doc123/delete/
WARNING 2025-08-06 03:51:58,078 basehttp 64187 123145570668544 "GET /doc123/delete/ HTTP/1.1" 403 39
INFO 2025-08-06 03:52:01,542 utils 64187 123145570668544 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:52:01,542 utils 64187 123145570668544 Extracted roles for user john_doe: []
INFO 2025-08-06 03:52:01,562 _client 64187 123145570668544 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 03:52:01,568 basehttp 64187 123145570668544 "GET /doc123/approve/ HTTP/1.1" 200 31
INFO 2025-08-06 03:53:32,863 autoreload 64187 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 03:53:34,881 autoreload 64246 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 03:54:40,124 utils 64246 123145458585600 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:54:40,125 utils 64246 123145458585600 Extracted roles for user john_doe: []
INFO 2025-08-06 03:54:40,140 _client 64246 123145458585600 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 03:54:40,147 basehttp 64246 123145458585600 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 03:54:42,909 utils 64246 123145458585600 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 03:54:42,910 utils 64246 123145458585600 Extracted roles for user john_doe: []
INFO 2025-08-06 03:54:42,915 _client 64246 123145458585600 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 03:54:42,920 basehttp 64246 123145458585600 "GET /doc123/edit/ HTTP/1.1" 200 33
INFO 2025-08-06 04:08:15,522 basehttp 64246 123145458585600 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 04:08:17,714 basehttp 64246 123145458585600 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 04:08:17,728 basehttp 64246 123145458585600 "GET / HTTP/1.1" 200 941
INFO 2025-08-06 04:08:20,037 basehttp 64246 123145458585600 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 04:08:21,767 basehttp 64246 123145458585600 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 04:08:23,107 basehttp 64246 123145458585600 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 04:08:23,343 basehttp 64246 123145458585600 "GET /accounts/oidc/keycloak/login/callback/?state=Cc8NjJIJouQAKKeQ&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=f593400a-f654-4348-9786-aa295bad0f6a.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 04:08:23,353 basehttp 64246 123145458585600 "GET /documents/ HTTP/1.1" 200 2003
INFO 2025-08-06 04:08:33,011 utils 64246 123145458585600 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'email_verified': True, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:08:33,012 utils 64246 123145458585600 Extracted roles for user john_doe: []
INFO 2025-08-06 04:08:33,028 _client 64246 123145458585600 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:08:33,033 basehttp 64246 123145458585600 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 04:12:50,121 basehttp 64246 123145458585600 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 2206
INFO 2025-08-06 04:12:51,693 basehttp 64246 123145458585600 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 04:12:51,956 basehttp 64246 123145458585600 "GET /accounts/oidc/keycloak/login/callback/?state=YlqHYnfbuoKqRdfR&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=3c7d4fcf-8d69-4c58-a959-8691a7544517.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 04:12:51,977 basehttp 64246 123145458585600 "GET /documents/ HTTP/1.1" 200 2003
INFO 2025-08-06 04:12:59,901 utils 64246 123145458585600 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:12:59,901 utils 64246 123145458585600 Extracted roles for user john_doe: ['admin', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:12:59,959 _client 64246 123145458585600 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:12:59,970 basehttp 64246 123145458585600 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 04:19:24,585 autoreload 64246 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 04:19:25,954 autoreload 65063 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 04:19:47,527 basehttp 65063 123145550503936 "GET /doc123/view/ HTTP/1.1" 302 0
INFO 2025-08-06 04:19:47,605 basehttp 65063 123145550503936 "GET /accounts/login/?next=/doc123/view/ HTTP/1.1" 200 2605
INFO 2025-08-06 04:19:49,983 basehttp 65063 123145550503936 "GET /accounts/oidc/keycloak/login/?process=login&next=%2Fdoc123%2Fview%2F HTTP/1.1" 200 1416
INFO 2025-08-06 04:19:51,364 basehttp 65063 123145550503936 "POST /accounts/oidc/keycloak/login/?process=login&next=%2Fdoc123%2Fview%2F HTTP/1.1" 302 0
INFO 2025-08-06 04:19:51,624 basehttp 65063 123145550503936 "GET /accounts/oidc/keycloak/login/callback/?state=qQ4BPPmsTcsvMXSl&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=0a653779-a5fa-409e-8fff-e852e075edd2.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 04:19:51,631 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:19:51,631 utils 65063 123145550503936 Extracted roles for user john_doe: ['admin', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:19:51,645 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:19:51,650 basehttp 65063 123145550503936 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 04:20:00,279 basehttp 65063 123145550503936 "GET / HTTP/1.1" 200 2003
INFO 2025-08-06 04:20:04,679 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:20:04,679 utils 65063 123145550503936 Extracted roles for user john_doe: ['admin', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:20:04,696 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:20:04,703 basehttp 65063 123145550503936 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 04:21:51,041 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:21:51,043 utils 65063 123145550503936 Extracted roles for user john_doe: ['admin', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:21:51,060 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:21:51,068 basehttp 65063 123145550503936 "GET /doc123/approve/ HTTP/1.1" 200 31
INFO 2025-08-06 04:21:52,974 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:21:52,975 utils 65063 123145550503936 Extracted roles for user john_doe: ['admin', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:21:52,981 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:21:52,986 basehttp 65063 123145550503936 "GET /doc123/delete/ HTTP/1.1" 200 30
INFO 2025-08-06 04:22:46,012 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:22:46,012 utils 65063 123145550503936 Extracted roles for user john_doe: ['admin', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:22:46,039 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:22:46,046 basehttp 65063 123145550503936 "GET /doc123/approve/ HTTP/1.1" 200 31
INFO 2025-08-06 04:23:26,564 basehttp 65063 123145550503936 "GET / HTTP/1.1" 200 2003
INFO 2025-08-06 04:23:31,717 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:23:31,717 utils 65063 123145550503936 Extracted roles for user john_doe: ['admin', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:23:31,765 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:23:31,774 basehttp 65063 123145550503936 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 04:23:42,332 basehttp 65063 123145550503936 "GET / HTTP/1.1" 200 941
INFO 2025-08-06 04:23:43,712 basehttp 65063 123145550503936 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-06 04:23:44,996 basehttp 65063 123145550503936 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 04:23:45,852 basehttp 65063 123145550503936 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 04:23:46,152 basehttp 65063 123145550503936 "GET /accounts/oidc/keycloak/login/callback/?state=oNQpNlyAGxGKM3VZ&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=0bc937ac-ebdd-45d9-8a56-96869dfbde0f.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 04:23:46,164 basehttp 65063 123145550503936 "GET /documents/ HTTP/1.1" 200 2003
INFO 2025-08-06 04:23:50,386 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:23:50,386 utils 65063 123145550503936 Extracted roles for user john_doe: ['manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:23:50,398 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 04:23:50,406 log 65063 123145550503936 Forbidden: /doc123/view/
WARNING 2025-08-06 04:23:50,408 basehttp 65063 123145550503936 "GET /doc123/view/ HTTP/1.1" 403 37
INFO 2025-08-06 04:23:58,662 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:23:58,663 utils 65063 123145550503936 Extracted roles for user john_doe: ['manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:23:58,670 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 04:23:58,678 log 65063 123145550503936 Forbidden: /doc123/edit/
WARNING 2025-08-06 04:23:58,678 basehttp 65063 123145550503936 "GET /doc123/edit/ HTTP/1.1" 403 37
INFO 2025-08-06 04:24:00,953 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:24:00,954 utils 65063 123145550503936 Extracted roles for user john_doe: ['manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:24:00,966 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:24:00,972 basehttp 65063 123145550503936 "GET /doc123/approve/ HTTP/1.1" 200 31
INFO 2025-08-06 04:24:07,381 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:24:07,383 utils 65063 123145550503936 Extracted roles for user john_doe: ['manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:24:07,412 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 04:24:07,419 log 65063 123145550503936 Forbidden: /doc123/delete/
WARNING 2025-08-06 04:24:07,420 basehttp 65063 123145550503936 "GET /doc123/delete/ HTTP/1.1" 403 39
INFO 2025-08-06 04:24:22,978 basehttp 65063 123145550503936 "GET /documents/ HTTP/1.1" 200 2003
INFO 2025-08-06 04:24:24,930 basehttp 65063 123145550503936 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 04:24:25,739 basehttp 65063 123145550503936 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 04:24:25,744 basehttp 65063 123145550503936 "GET / HTTP/1.1" 200 941
INFO 2025-08-06 04:24:27,369 basehttp 65063 123145550503936 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 04:24:28,708 basehttp 65063 123145550503936 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 04:24:29,670 basehttp 65063 123145550503936 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 04:24:29,855 basehttp 65063 123145550503936 "GET /accounts/oidc/keycloak/login/callback/?state=W5TQAEp9jPNkbAs2&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=5522e20e-d5e9-4db4-b9b8-f24470f83926.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 04:24:29,868 basehttp 65063 123145550503936 "GET /documents/ HTTP/1.1" 200 2003
INFO 2025-08-06 04:24:34,471 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:24:34,471 utils 65063 123145550503936 Extracted roles for user john_doe: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:24:34,483 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:24:34,489 basehttp 65063 123145550503936 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 04:24:38,088 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:24:38,088 utils 65063 123145550503936 Extracted roles for user john_doe: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:24:38,129 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:24:38,167 basehttp 65063 123145550503936 "GET /doc123/edit/ HTTP/1.1" 200 33
INFO 2025-08-06 04:24:41,282 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:24:41,283 utils 65063 123145550503936 Extracted roles for user john_doe: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:24:41,296 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 04:24:41,301 log 65063 123145550503936 Forbidden: /doc123/delete/
WARNING 2025-08-06 04:24:41,302 basehttp 65063 123145550503936 "GET /doc123/delete/ HTTP/1.1" 403 39
INFO 2025-08-06 04:24:43,283 utils 65063 123145550503936 Extra data from social account: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:24:43,284 utils 65063 123145550503936 Extracted roles for user john_doe: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:24:43,298 _client 65063 123145550503936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:24:43,304 basehttp 65063 123145550503936 "GET /doc123/approve/ HTTP/1.1" 200 31
INFO 2025-08-06 04:28:16,544 autoreload 65063 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/cerbos_client.py changed, reloading.
INFO 2025-08-06 04:28:18,226 autoreload 66273 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 04:46:08,011 autoreload 66273 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-06 04:46:10,145 autoreload 68004 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 04:49:08,914 autoreload 68004 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 04:49:10,871 autoreload 68264 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 04:49:37,417 basehttp 68264 123145488551936 "GET / HTTP/1.1" 200 2003
INFO 2025-08-06 04:49:39,363 basehttp 68264 123145488551936 "GET /accounts/logout/ HTTP/1.1" 200 1951
INFO 2025-08-06 04:49:40,302 basehttp 68264 123145488551936 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 04:49:40,310 basehttp 68264 123145488551936 "GET / HTTP/1.1" 200 941
INFO 2025-08-06 04:49:41,595 basehttp 68264 123145488551936 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 04:49:46,230 basehttp 68264 123145488551936 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 04:49:47,346 basehttp 68264 123145488551936 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 04:49:47,812 basehttp 68264 123145488551936 "GET /accounts/oidc/keycloak/login/callback/?state=dxs9BFc2e1QtMv5J&session_state=274fb903-d864-49d9-8e4d-32511248c768&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=bbf10cab-532b-4f76-8565-192081642462.274fb903-d864-49d9-8e4d-32511248c768.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 04:49:47,823 basehttp 68264 123145488551936 "GET /documents/ HTTP/1.1" 200 2003
INFO 2025-08-06 04:49:52,741 utils 68264 123145488551936 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:49:52,742 utils 68264 123145488551936 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:49:52,766 _client 68264 123145488551936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:49:52,778 basehttp 68264 123145488551936 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 04:49:59,250 utils 68264 123145488551936 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:49:59,251 utils 68264 123145488551936 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:49:59,266 _client 68264 123145488551936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:49:59,274 basehttp 68264 123145488551936 "GET /doc123/edit/ HTTP/1.1" 200 33
INFO 2025-08-06 04:50:02,032 utils 68264 123145488551936 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:50:02,032 utils 68264 123145488551936 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:50:02,039 _client 68264 123145488551936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 04:50:02,047 log 68264 123145488551936 Forbidden: /doc123/delete/
WARNING 2025-08-06 04:50:02,048 basehttp 68264 123145488551936 "GET /doc123/delete/ HTTP/1.1" 403 39
INFO 2025-08-06 04:50:04,247 utils 68264 123145488551936 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 04:50:04,248 utils 68264 123145488551936 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 04:50:04,256 _client 68264 123145488551936 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 04:50:04,261 basehttp 68264 123145488551936 "GET /doc123/approve/ HTTP/1.1" 200 31
INFO 2025-08-06 06:44:19,765 autoreload 68264 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/django_cerbos_keycloak/settings.py changed, reloading.
INFO 2025-08-06 06:44:21,564 autoreload 73759 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 06:44:23,526 autoreload 73759 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/django_cerbos_keycloak/settings.py changed, reloading.
INFO 2025-08-06 06:44:24,352 autoreload 73760 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 06:44:26,134 autoreload 73760 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/django_cerbos_keycloak/settings.py changed, reloading.
INFO 2025-08-06 06:44:26,995 autoreload 73764 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 06:49:58,408 autoreload 73764 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-06 06:50:00,524 autoreload 73996 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 06:50:09,205 basehttp 73996 123145462759424 "GET /documents/ HTTP/1.1" 200 2003
INFO 2025-08-06 06:50:12,805 basehttp 73996 123145462759424 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 06:50:14,120 basehttp 73996 123145462759424 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 06:50:14,125 basehttp 73996 123145462759424 "GET / HTTP/1.1" 200 941
INFO 2025-08-06 06:50:20,114 basehttp 73996 123145462759424 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 06:50:21,294 basehttp 73996 123145462759424 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 06:50:22,507 basehttp 73996 123145462759424 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 06:50:34,459 basehttp 73996 123145462759424 "GET /accounts/oidc/keycloak/login/callback/?state=lCpYNLlPVunLkJap&session_state=63aae6ed-ad57-483c-9a4a-af37dd904a64&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=d710feba-cc8a-4f7a-bb08-637931fc82ec.63aae6ed-ad57-483c-9a4a-af37dd904a64.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 06:50:34,472 basehttp 73996 123145462759424 "GET /documents/ HTTP/1.1" 200 2003
INFO 2025-08-06 06:50:43,521 utils 73996 123145462759424 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 06:50:43,524 utils 73996 123145462759424 [SESSION] Extracted roles: ['view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 06:50:43,610 _client 73996 123145462759424 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 06:50:43,617 basehttp 73996 123145462759424 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 06:51:15,208 utils 73996 123145462759424 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 06:51:15,209 utils 73996 123145462759424 [SESSION] Extracted roles: ['view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 06:51:15,232 _client 73996 123145462759424 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 06:51:15,241 log 73996 123145462759424 Forbidden: /doc123/delete/
WARNING 2025-08-06 06:51:15,241 basehttp 73996 123145462759424 "GET /doc123/delete/ HTTP/1.1" 403 39
INFO 2025-08-06 06:53:31,541 autoreload 73996 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-06 06:53:32,735 autoreload 74134 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 06:55:33,140 autoreload 74134 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 06:55:34,375 autoreload 74364 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 07:11:08,022 utils 74364 123145487163392 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:11:08,023 utils 74364 123145487163392 [SESSION] Extracted roles: ['manage-account-links', 'user', 'view-profile', 'manage-account']
INFO 2025-08-06 07:11:08,043 _client 74364 123145487163392 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 07:11:08,052 log 74364 123145487163392 Forbidden: /doc123/delete/
WARNING 2025-08-06 07:11:08,053 basehttp 74364 123145487163392 "GET /doc123/delete/ HTTP/1.1" 403 39
INFO 2025-08-06 07:11:10,831 utils 74364 123145487163392 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:11:10,832 utils 74364 123145487163392 [SESSION] Extracted roles: ['manage-account-links', 'user', 'view-profile', 'manage-account']
INFO 2025-08-06 07:11:10,863 _client 74364 123145487163392 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:11:10,870 basehttp 74364 123145487163392 "GET /doc123/view/ HTTP/1.1" 200 32
INFO 2025-08-06 07:26:01,609 autoreload 74364 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 07:26:03,349 autoreload 75453 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 07:26:27,849 autoreload 75453 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 07:26:29,021 autoreload 75470 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 07:29:11,023 basehttp 75470 123145522991104 "GET /doc123/view/ HTTP/1.1" 302 0
INFO 2025-08-06 07:29:11,205 basehttp 75470 123145522991104 "GET /accounts/login/?next=/doc123/view/ HTTP/1.1" 200 2605
INFO 2025-08-06 07:29:13,360 basehttp 75470 123145522991104 "GET /accounts/oidc/keycloak/login/?process=login&next=%2Fdoc123%2Fview%2F HTTP/1.1" 200 1416
INFO 2025-08-06 07:29:15,352 basehttp 75470 123145522991104 "POST /accounts/oidc/keycloak/login/?process=login&next=%2Fdoc123%2Fview%2F HTTP/1.1" 302 0
INFO 2025-08-06 07:29:24,226 basehttp 75470 123145522991104 "GET /accounts/oidc/keycloak/login/callback/?state=QL0XYRMkxN0pMZUY&session_state=9f49f93e-57ac-4cc2-81ea-c8b6ef329abd&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=e2c250ce-e203-4e96-822f-20114c50aba7.9f49f93e-57ac-4cc2-81ea-c8b6ef329abd.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 07:29:24,236 utils 75470 123145522991104 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:29:24,236 utils 75470 123145522991104 [SESSION] Extracted roles: ['user', 'view-profile', 'manage-account-links', 'manage-account']
INFO 2025-08-06 07:29:24,256 _client 75470 123145522991104 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:29:24,269 _client 75470 123145522991104 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:29:24,281 _client 75470 123145522991104 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:29:24,311 _client 75470 123145522991104 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
ERROR 2025-08-06 07:29:24,404 log 75470 123145522991104 Internal Server Error: /doc123/view/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 158, in manage_document
    return render(request, 'documents/view.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/view.html
ERROR 2025-08-06 07:29:24,412 basehttp 75470 123145522991104 "GET /doc123/view/ HTTP/1.1" 500 103228
INFO 2025-08-06 07:29:30,641 utils 75470 123145522991104 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:29:30,641 utils 75470 123145522991104 [SESSION] Extracted roles: ['user', 'view-profile', 'manage-account-links', 'manage-account']
INFO 2025-08-06 07:29:30,659 basehttp 75470 123145522991104 "GET / HTTP/1.1" 200 15785
INFO 2025-08-06 07:29:51,211 utils 75470 123145522991104 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:29:51,212 utils 75470 123145522991104 [SESSION] Extracted roles: ['user', 'view-profile', 'manage-account-links', 'manage-account']
INFO 2025-08-06 07:29:51,240 _client 75470 123145522991104 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
ERROR 2025-08-06 07:29:51,311 log 75470 123145522991104 Internal Server Error: /api/check-permission/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 141, in manage_document
    return render(request, 'documents/forbidden.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/forbidden.html

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 150, in manage_document
    return render(request, 'documents/error.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/error.html
ERROR 2025-08-06 07:29:51,312 basehttp 75470 123145522991104 "POST /api/check-permission/ HTTP/1.1" 500 124148
INFO 2025-08-06 07:29:57,143 utils 75470 123145522991104 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:29:57,143 utils 75470 123145522991104 [SESSION] Extracted roles: ['user', 'view-profile', 'manage-account-links', 'manage-account']
INFO 2025-08-06 07:29:57,155 _client 75470 123145522991104 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
ERROR 2025-08-06 07:29:57,198 log 75470 123145522991104 Internal Server Error: /api/check-permission/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 141, in manage_document
    return render(request, 'documents/forbidden.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/forbidden.html

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 150, in manage_document
    return render(request, 'documents/error.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/error.html
ERROR 2025-08-06 07:29:57,199 basehttp 75470 123145522991104 "POST /api/check-permission/ HTTP/1.1" 500 124148
INFO 2025-08-06 07:29:59,615 utils 75470 123145522991104 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:29:59,615 utils 75470 123145522991104 [SESSION] Extracted roles: ['user', 'view-profile', 'manage-account-links', 'manage-account']
INFO 2025-08-06 07:29:59,628 _client 75470 123145522991104 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
ERROR 2025-08-06 07:29:59,706 log 75470 123145522991104 Internal Server Error: /api/check-permission/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 141, in manage_document
    return render(request, 'documents/forbidden.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/forbidden.html

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 150, in manage_document
    return render(request, 'documents/error.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/error.html
ERROR 2025-08-06 07:29:59,708 basehttp 75470 123145522991104 "POST /api/check-permission/ HTTP/1.1" 500 124148
WARNING 2025-08-06 07:30:56,471 log 75470 123145522991104 Not Found: /.well-known/appspecific/com.chrome.devtools.json
WARNING 2025-08-06 07:30:56,474 basehttp 75470 123145522991104 "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 2830
INFO 2025-08-06 07:31:50,776 utils 75470 123145522991104 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:31:50,776 utils 75470 123145522991104 [SESSION] Extracted roles: ['user', 'view-profile', 'manage-account-links', 'manage-account']
INFO 2025-08-06 07:31:50,783 basehttp 75470 123145522991104 "GET / HTTP/1.1" 200 15785
WARNING 2025-08-06 07:31:50,923 log 75470 123145522991104 Not Found: /.well-known/appspecific/com.chrome.devtools.json
WARNING 2025-08-06 07:31:50,924 basehttp 75470 123145522991104 "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 2830
INFO 2025-08-06 07:31:53,647 utils 75470 123145522991104 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:31:53,647 utils 75470 123145522991104 [SESSION] Extracted roles: ['user', 'view-profile', 'manage-account-links', 'manage-account']
INFO 2025-08-06 07:31:53,661 _client 75470 123145522991104 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
ERROR 2025-08-06 07:31:53,716 log 75470 123145522991104 Internal Server Error: /api/check-permission/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 141, in manage_document
    return render(request, 'documents/forbidden.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/forbidden.html

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 150, in manage_document
    return render(request, 'documents/error.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/error.html
ERROR 2025-08-06 07:31:53,718 basehttp 75470 123145522991104 "POST /api/check-permission/ HTTP/1.1" 500 124148
INFO 2025-08-06 07:48:26,792 autoreload 75470 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 07:48:31,354 autoreload 76253 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 07:49:55,622 autoreload 76253 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 07:49:57,285 autoreload 76308 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 07:54:37,844 utils 76308 123145481433088 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:54:37,845 utils 76308 123145481433088 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:54:37,917 basehttp 76308 123145481433088 "GET / HTTP/1.1" 200 41527
INFO 2025-08-06 07:54:38,685 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:54:38,685 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:54:38,818 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 07:54:38,863 log 76308 123145481433088 Not Found: /.well-known/appspecific/com.chrome.devtools.json
WARNING 2025-08-06 07:54:38,864 basehttp 76308 123145481433088 "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 3582
INFO 2025-08-06 07:54:38,869 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:38,955 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,098 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,120 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,217 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,228 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,242 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,259 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,298 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,310 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,335 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,353 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,378 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,402 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,412 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:39,424 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:54:46,884 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:54:46,886 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:54:46,886 views 76308 123145498222592 User: john_doe, Roles: ['user', 'manage-account', 'manage-account-links', 'view-profile'], Action: view, Document: doc123
INFO 2025-08-06 07:54:46,957 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:46,959 views 76308 123145498222592 Access granted: john_doe can view document doc123
ERROR 2025-08-06 07:54:47,218 log 76308 123145498222592 Internal Server Error: /documents/doc123/view/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 132, in manage_document
    return render(request, 'documents/view_document.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 33, in get_template
    return Template(self.engine.get_template(template_name), self)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/engine.py", line 175, in get_template
    template, origin = self.find_template(template_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/engine.py", line 157, in find_template
    template = loader.get_template(name, skip=skip)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 200, in compile_nodelist
    return parser.parse()
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 513, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 511, in parse
    compiled_result = compile_func(self, token)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 853, in do_for
    nodelist_loop = parser.parse(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 513, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 511, in parse
    compiled_result = compile_func(self, token)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 853, in do_for
    nodelist_loop = parser.parse(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 484, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 482, in parse
    filter_expression = self.compile_filter(token.contents)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 600, in compile_filter
    return FilterExpression(token, self)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 698, in __init__
    filter_func = parser.find_filter(filter_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 606, in find_filter
    raise TemplateSyntaxError("Invalid filter: '%s'" % filter_name)
django.template.exceptions.TemplateSyntaxError: Invalid filter: 'get_item'
ERROR 2025-08-06 07:54:47,247 basehttp 76308 123145498222592 "GET /documents/doc123/view/ HTTP/1.1" 500 247931
INFO 2025-08-06 07:54:59,025 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:54:59,026 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:54:59,038 basehttp 76308 123145498222592 "GET / HTTP/1.1" 200 41527
INFO 2025-08-06 07:54:59,149 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:54:59,149 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:54:59,169 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,191 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,252 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,294 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,307 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,336 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,355 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,384 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,409 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,435 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,447 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,478 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,505 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,527 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,544 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,573 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:54:59,579 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:55:00,568 basehttp 76308 123145498222592 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 07:55:02,099 basehttp 76308 123145498222592 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 07:55:02,104 basehttp 76308 123145498222592 "GET / HTTP/1.1" 200 25083
INFO 2025-08-06 07:55:04,649 basehttp 76308 123145498222592 "GET / HTTP/1.1" 200 25083
INFO 2025-08-06 07:55:05,330 basehttp 76308 123145498222592 "GET / HTTP/1.1" 200 25083
INFO 2025-08-06 07:55:05,923 basehttp 76308 123145498222592 "GET / HTTP/1.1" 200 25083
INFO 2025-08-06 07:55:07,174 basehttp 76308 123145498222592 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 07:55:08,483 basehttp 76308 123145498222592 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 07:55:10,222 basehttp 76308 123145498222592 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 07:55:11,764 basehttp 76308 123145498222592 "GET /accounts/oidc/keycloak/login/callback/?state=tqvmgxJJmqAXCcR4&session_state=9f49f93e-57ac-4cc2-81ea-c8b6ef329abd&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=040280c6-09a6-4938-a35f-d9a52115e48d.9f49f93e-57ac-4cc2-81ea-c8b6ef329abd.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 07:55:11,772 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:55:11,773 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:55:11,782 basehttp 76308 123145498222592 "GET /documents/ HTTP/1.1" 200 41527
INFO 2025-08-06 07:55:11,948 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:55:11,948 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:55:11,972 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:11,984 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:11,995 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,007 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,025 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,047 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,057 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,075 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,099 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,119 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,132 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,143 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,156 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,163 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,175 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,186 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:12,190 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:55:41,816 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:55:41,816 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:55:41,825 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,832 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,840 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,845 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,852 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,861 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,869 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,874 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,881 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,890 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,897 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,904 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,911 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,918 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,928 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,936 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:41,943 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:55:47,427 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:55:47,427 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:55:47,427 views 76308 123145498222592 User: john_doe, Roles: ['user', 'manage-account', 'manage-account-links', 'view-profile'], Action: approve, Document: doc123
INFO 2025-08-06 07:55:47,446 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:47,449 views 76308 123145498222592 Access granted: john_doe can approve document doc123
ERROR 2025-08-06 07:55:47,505 log 76308 123145498222592 Internal Server Error: /documents/doc123/approve/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 158, in manage_document
    return render(request, 'documents/action_result.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/action_result.html
ERROR 2025-08-06 07:55:47,506 basehttp 76308 123145498222592 "GET /documents/doc123/approve/ HTTP/1.1" 500 100673
INFO 2025-08-06 07:55:51,742 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:55:51,742 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:55:51,743 views 76308 123145498222592 User: john_doe, Roles: ['user', 'manage-account', 'manage-account-links', 'view-profile'], Action: view, Document: doc123
INFO 2025-08-06 07:55:51,756 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:55:51,758 views 76308 123145498222592 Access granted: john_doe can view document doc123
ERROR 2025-08-06 07:55:51,889 log 76308 123145498222592 Internal Server Error: /documents/doc123/view/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 132, in manage_document
    return render(request, 'documents/view_document.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 33, in get_template
    return Template(self.engine.get_template(template_name), self)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/engine.py", line 175, in get_template
    template, origin = self.find_template(template_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/engine.py", line 157, in find_template
    template = loader.get_template(name, skip=skip)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 200, in compile_nodelist
    return parser.parse()
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 513, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 511, in parse
    compiled_result = compile_func(self, token)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 853, in do_for
    nodelist_loop = parser.parse(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 513, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 511, in parse
    compiled_result = compile_func(self, token)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 853, in do_for
    nodelist_loop = parser.parse(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 484, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 482, in parse
    filter_expression = self.compile_filter(token.contents)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 600, in compile_filter
    return FilterExpression(token, self)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 698, in __init__
    filter_func = parser.find_filter(filter_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 606, in find_filter
    raise TemplateSyntaxError("Invalid filter: '%s'" % filter_name)
django.template.exceptions.TemplateSyntaxError: Invalid filter: 'get_item'
ERROR 2025-08-06 07:55:51,891 basehttp 76308 123145498222592 "GET /documents/doc123/view/ HTTP/1.1" 500 248016
INFO 2025-08-06 07:56:11,835 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:56:11,836 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:56:11,856 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:11,880 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:11,906 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:11,977 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,078 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,171 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,201 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,226 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,249 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,276 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,299 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,343 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,373 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,390 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,428 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,488 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:12,501 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:56:41,815 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:56:41,816 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:56:41,846 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:41,871 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:41,887 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:41,917 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:41,939 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:41,972 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:41,990 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,014 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,035 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,048 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,057 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,081 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,094 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,104 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,122 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,131 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:56:42,135 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:57:11,836 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:57:11,838 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:57:11,859 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,869 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,879 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,892 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,901 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,909 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,917 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,924 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,932 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,939 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,947 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,953 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,960 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,969 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,979 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,985 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:11,994 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:57:41,815 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:57:41,815 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:57:41,831 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,842 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,852 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,862 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,873 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,883 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,893 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,902 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,915 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,927 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,936 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,947 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,955 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,964 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,971 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,978 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:57:41,983 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:58:11,820 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:58:11,821 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:58:11,838 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,856 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,865 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,876 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,883 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,890 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,898 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,905 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,912 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,920 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,926 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,933 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,940 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,947 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,953 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,958 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:11,962 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:58:24,933 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:58:24,936 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:58:24,965 basehttp 76308 123145498222592 "GET / HTTP/1.1" 200 41527
INFO 2025-08-06 07:58:25,045 utils 76308 123145498222592 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 07:58:25,047 utils 76308 123145498222592 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 07:58:25,072 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,100 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,108 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,115 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,122 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,134 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,142 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,153 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,163 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,182 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,193 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,205 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,210 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,217 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,225 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,233 _client 76308 123145498222592 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:25,238 basehttp 76308 123145498222592 "GET /api/user/permissions/ HTTP/1.1" 200 599
INFO 2025-08-06 07:58:36,810 basehttp 76308 123145498222592 "GET /test/scenarios HTTP/1.1" 301 0
INFO 2025-08-06 07:58:36,834 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,838 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,842 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,851 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,858 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,864 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,872 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,885 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,892 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,902 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,907 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,915 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,923 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,931 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,936 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,942 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,950 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,956 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,966 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,971 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,977 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,984 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,989 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:36,994 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:37,002 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:37,007 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:37,012 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:37,023 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:37,035 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:37,045 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:37,052 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 07:58:37,061 _client 76308 123145481433088 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
ERROR 2025-08-06 07:58:37,139 log 76308 123145481433088 Internal Server Error: /test/scenarios/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 308, in test_scenarios
    return render(request, 'documents/test_scenarios.html', {
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/test_scenarios.html
ERROR 2025-08-06 07:58:37,165 basehttp 76308 123145481433088 "GET /test/scenarios/ HTTP/1.1" 500 124649
INFO 2025-08-06 08:03:19,093 autoreload 76308 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 08:03:21,808 autoreload 76775 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:03:59,533 autoreload 76775 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 08:04:03,621 autoreload 76807 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:06:31,087 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:06:31,090 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:06:31,138 basehttp 76807 123145543303168 "GET / HTTP/1.1" 200 23547
INFO 2025-08-06 08:06:34,023 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:06:34,023 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:06:34,024 views 76807 123145543303168 [] User: john_doe, Roles: ['manage-account', 'user', 'view-profile', 'manage-account-links'], Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:06:34,058 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 08:06:34,061 views 76807 123145543303168 [] Access denied - User: john_doe, Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:06:34,063 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:06:34,064 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
WARNING 2025-08-06 08:06:34,069 log 76807 123145543303168 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-06 08:06:34,070 basehttp 76807 123145543303168 "GET /doc_marketing_001/view/ HTTP/1.1" 403 8287
INFO 2025-08-06 08:06:38,890 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:06:38,894 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:06:38,896 views 76807 123145543303168 [] User: john_doe, Roles: ['manage-account', 'user', 'view-profile', 'manage-account-links'], Action: approve, Document: doc_marketing_001
INFO 2025-08-06 08:06:38,911 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:06:38,916 views 76807 123145543303168 [] Access granted - User: john_doe, Action: approve, Document: doc_marketing_001
INFO 2025-08-06 08:06:38,932 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:06:38,951 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:06:38,982 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
ERROR 2025-08-06 08:06:39,102 log 76807 123145543303168 Internal Server Error: /doc_marketing_001/approve/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 150, in manage_document
    return _execute_document_action(request, document, action, user_roles)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 249, in _execute_document_action
    return render(request, 'documents/action_result.html', context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 61, in render
    return self.template.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 175, in render
    return self._render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 167, in _render
    return self.nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'test_scenarios' not found. 'test_scenarios' is not a valid view function or pattern name.
ERROR 2025-08-06 08:06:39,119 basehttp 76807 123145543303168 "GET /doc_marketing_001/approve/ HTTP/1.1" 500 152512
INFO 2025-08-06 08:06:42,110 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:06:42,110 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:06:42,110 views 76807 123145543303168 [] User: john_doe, Roles: ['manage-account', 'user', 'view-profile', 'manage-account-links'], Action: edit, Document: doc_marketing_001
INFO 2025-08-06 08:06:42,120 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 08:06:42,122 views 76807 123145543303168 [] Access denied - User: john_doe, Action: edit, Document: doc_marketing_001
INFO 2025-08-06 08:06:42,123 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:06:42,123 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
WARNING 2025-08-06 08:06:42,125 log 76807 123145543303168 Forbidden: /doc_marketing_001/edit/
WARNING 2025-08-06 08:06:42,127 basehttp 76807 123145543303168 "GET /doc_marketing_001/edit/ HTTP/1.1" 403 8287
INFO 2025-08-06 08:07:34,645 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:07:34,646 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:07:34,656 basehttp 76807 123145543303168 "GET / HTTP/1.1" 200 23547
INFO 2025-08-06 08:07:35,661 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:07:35,661 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:07:35,667 basehttp 76807 123145543303168 "GET / HTTP/1.1" 200 23547
INFO 2025-08-06 08:07:37,209 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:07:37,214 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:07:37,215 views 76807 123145543303168 [] User: john_doe, Roles: ['manage-account', 'user', 'view-profile', 'manage-account-links'], Action: view, Document: doc_it_004
INFO 2025-08-06 08:07:37,235 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 08:07:37,240 views 76807 123145543303168 [] Access denied - User: john_doe, Action: view, Document: doc_it_004
INFO 2025-08-06 08:07:37,241 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:07:37,242 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
WARNING 2025-08-06 08:07:37,247 log 76807 123145543303168 Forbidden: /doc_it_004/view/
WARNING 2025-08-06 08:07:37,248 basehttp 76807 123145543303168 "GET /doc_it_004/view/ HTTP/1.1" 403 8263
INFO 2025-08-06 08:08:02,392 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:08:02,393 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:08:02,410 basehttp 76807 123145543303168 "GET / HTTP/1.1" 200 23547
INFO 2025-08-06 08:08:03,352 basehttp 76807 123145543303168 "GET /accounts/logout/ HTTP/1.1" 200 2246
INFO 2025-08-06 08:08:04,453 basehttp 76807 123145543303168 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 08:08:04,459 basehttp 76807 123145543303168 "GET / HTTP/1.1" 200 9774
INFO 2025-08-06 08:08:05,767 basehttp 76807 123145543303168 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 08:08:15,543 basehttp 76807 123145543303168 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 08:08:17,020 basehttp 76807 123145543303168 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 08:08:19,068 basehttp 76807 123145543303168 "GET /accounts/oidc/keycloak/login/callback/?state=p2M9RilCxQ0ODgcF&session_state=9f49f93e-57ac-4cc2-81ea-c8b6ef329abd&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=d1fd7790-a4ac-4fac-8a22-4a0748f4e20e.9f49f93e-57ac-4cc2-81ea-c8b6ef329abd.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 08:08:19,076 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:08:19,076 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:08:19,088 basehttp 76807 123145543303168 "GET /documents/ HTTP/1.1" 200 23547
INFO 2025-08-06 08:08:26,879 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:08:26,880 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:08:26,880 views 76807 123145543303168 [] User: john_doe, Roles: ['manage-account', 'user', 'view-profile', 'manage-account-links'], Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:08:26,894 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 08:08:26,898 views 76807 123145543303168 [] Access denied - User: john_doe, Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:08:26,901 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:08:26,902 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
WARNING 2025-08-06 08:08:26,905 log 76807 123145543303168 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-06 08:08:26,905 basehttp 76807 123145543303168 "GET /doc_marketing_001/view/ HTTP/1.1" 403 8287
INFO 2025-08-06 08:09:16,602 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:09:16,604 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'user', 'view-profile', 'manage-account-links']
INFO 2025-08-06 08:09:16,620 basehttp 76807 123145543303168 "GET / HTTP/1.1" 200 23547
INFO 2025-08-06 08:09:20,284 basehttp 76807 123145543303168 "GET /accounts/logout/ HTTP/1.1" 200 1951
INFO 2025-08-06 08:09:21,165 basehttp 76807 123145543303168 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 08:09:21,170 basehttp 76807 123145543303168 "GET / HTTP/1.1" 200 9774
INFO 2025-08-06 08:09:22,823 basehttp 76807 123145543303168 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 08:09:23,748 basehttp 76807 123145543303168 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 08:09:24,774 basehttp 76807 123145543303168 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 08:09:25,014 basehttp 76807 123145543303168 "GET /accounts/oidc/keycloak/login/callback/?state=oTTy6RGjQyB1cVV1&session_state=9f49f93e-57ac-4cc2-81ea-c8b6ef329abd&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=fc07633a-0e74-4cc1-aae1-c0a32f559e86.9f49f93e-57ac-4cc2-81ea-c8b6ef329abd.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 08:09:25,041 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:09:25,042 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'view-profile', 'admin', 'manage-account-links']
INFO 2025-08-06 08:09:25,078 basehttp 76807 123145543303168 "GET /documents/ HTTP/1.1" 200 23547
INFO 2025-08-06 08:09:27,968 utils 76807 123145543303168 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:09:27,969 utils 76807 123145543303168 [SESSION] Extracted roles: ['manage-account', 'view-profile', 'admin', 'manage-account-links']
INFO 2025-08-06 08:09:27,969 views 76807 123145543303168 [] User: john_doe, Roles: ['manage-account', 'view-profile', 'admin', 'manage-account-links'], Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:09:28,008 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:09:28,010 views 76807 123145543303168 [] Access granted - User: john_doe, Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:09:28,020 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:09:28,031 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:09:28,041 _client 76807 123145543303168 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
ERROR 2025-08-06 08:09:28,177 log 76807 123145543303168 Internal Server Error: /doc_marketing_001/view/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 150, in manage_document
    return _execute_document_action(request, document, action, user_roles)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 249, in _execute_document_action
    return render(request, 'documents/action_result.html', context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 61, in render
    return self.template.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 175, in render
    return self._render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 167, in _render
    return self.nodelist.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 1005, in <listcomp>
    return SafeString("".join([node.render_annotated(context) for node in self]))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 966, in render_annotated
    return self.render(context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 471, in render
    url = reverse(view_name, args=args, kwargs=kwargs, current_app=current_app)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/base.py", line 88, in reverse
    return resolver._reverse_with_prefix(view, prefix, *args, **kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/urls/resolvers.py", line 828, in _reverse_with_prefix
    raise NoReverseMatch(msg)
django.urls.exceptions.NoReverseMatch: Reverse for 'test_scenarios' not found. 'test_scenarios' is not a valid view function or pattern name.
ERROR 2025-08-06 08:09:28,182 basehttp 76807 123145543303168 "GET /doc_marketing_001/view/ HTTP/1.1" 500 151993
INFO 2025-08-06 08:13:38,658 autoreload 76807 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 08:13:40,701 autoreload 77133 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:13:47,620 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:13:47,621 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:13:47,621 views 77133 123145418715136 [] User: john_doe, Roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account'], Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:13:47,651 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:47,654 views 77133 123145418715136 [] Access granted - User: john_doe, Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:13:47,665 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:47,674 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:47,688 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:47,723 basehttp 77133 123145418715136 "GET /doc_marketing_001/view/ HTTP/1.1" 200 8944
INFO 2025-08-06 08:13:55,834 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:13:55,834 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:13:55,847 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,857 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,869 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,883 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,888 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,902 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,908 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,919 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,927 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,939 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,952 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,969 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,977 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:55,990 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:56,002 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:56,014 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:56,024 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:56,038 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:56,050 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:13:56,060 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
ERROR 2025-08-06 08:13:56,154 log 77133 123145418715136 Internal Server Error: /test-scenarios/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/contrib/auth/decorators.py", line 23, in _wrapper_view
    return view_func(request, *args, **kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 332, in test_scenarios
    return render(request, 'documents/test_scenarios.html', context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: documents/test_scenarios.html
ERROR 2025-08-06 08:13:56,162 basehttp 77133 123145418715136 "GET /test-scenarios/ HTTP/1.1" 500 115965
INFO 2025-08-06 08:14:04,801 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:14:04,802 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:14:04,853 basehttp 77133 123145418715136 "GET / HTTP/1.1" 200 23547
INFO 2025-08-06 08:14:06,098 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:14:06,098 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:14:06,098 views 77133 123145418715136 [] User: john_doe, Roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account'], Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:14:06,115 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:06,118 views 77133 123145418715136 [] Access granted - User: john_doe, Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:14:06,130 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:06,137 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:06,150 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:06,175 basehttp 77133 123145418715136 "GET /doc_marketing_001/view/ HTTP/1.1" 200 8944
INFO 2025-08-06 08:14:21,020 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:14:21,020 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:14:21,032 basehttp 77133 123145418715136 "GET / HTTP/1.1" 200 23547
INFO 2025-08-06 08:14:28,248 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:14:28,248 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:14:28,249 views 77133 123145418715136 [] User: john_doe, Roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account'], Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:14:28,262 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:28,266 views 77133 123145418715136 [] Access granted - User: john_doe, Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:14:28,276 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:28,289 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:28,304 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:28,312 basehttp 77133 123145418715136 "GET /doc_marketing_001/view/ HTTP/1.1" 200 8944
INFO 2025-08-06 08:14:56,634 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:14:56,639 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:14:56,640 views 77133 123145418715136 [] User: john_doe, Roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account'], Action: edit, Document: doc_marketing_001
INFO 2025-08-06 08:14:56,681 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:56,683 views 77133 123145418715136 [] Access granted - User: john_doe, Action: edit, Document: doc_marketing_001
INFO 2025-08-06 08:14:56,700 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:56,731 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:56,766 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:14:56,780 basehttp 77133 123145418715136 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 8944
INFO 2025-08-06 08:15:02,852 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:15:02,853 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:15:02,854 views 77133 123145418715136 [] User: john_doe, Roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account'], Action: view, Document: doc_hr_002
INFO 2025-08-06 08:15:02,862 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:15:02,866 views 77133 123145418715136 [] Access granted - User: john_doe, Action: view, Document: doc_hr_002
INFO 2025-08-06 08:15:02,874 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:15:02,883 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:15:02,893 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:15:02,899 basehttp 77133 123145418715136 "GET /doc_hr_002/view/ HTTP/1.1" 200 8901
INFO 2025-08-06 08:15:10,057 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:15:10,058 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:15:10,058 views 77133 123145418715136 [] User: john_doe, Roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account'], Action: view, Document: doc_it_004
INFO 2025-08-06 08:15:10,068 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:15:10,070 views 77133 123145418715136 [] Access granted - User: john_doe, Action: view, Document: doc_it_004
INFO 2025-08-06 08:15:10,081 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:15:10,088 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:15:10,095 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 08:15:10,100 basehttp 77133 123145418715136 "GET /doc_it_004/view/ HTTP/1.1" 200 8918
INFO 2025-08-06 08:15:43,384 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['admin']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:15:43,386 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'admin', 'view-profile', 'manage-account']
INFO 2025-08-06 08:15:43,401 basehttp 77133 123145418715136 "GET / HTTP/1.1" 200 23547
INFO 2025-08-06 08:15:48,583 basehttp 77133 123145418715136 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 08:15:49,460 basehttp 77133 123145418715136 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 08:15:49,466 basehttp 77133 123145418715136 "GET / HTTP/1.1" 200 9774
INFO 2025-08-06 08:15:50,411 basehttp 77133 123145418715136 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 08:15:51,599 basehttp 77133 123145418715136 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 08:15:52,699 basehttp 77133 123145418715136 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 08:15:53,005 basehttp 77133 123145418715136 "GET /accounts/oidc/keycloak/login/callback/?state=zfLfsiadHJf119EQ&session_state=9f49f93e-57ac-4cc2-81ea-c8b6ef329abd&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=6b05010a-3b2b-4d0d-8301-a9d993b160a3.9f49f93e-57ac-4cc2-81ea-c8b6ef329abd.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 08:15:53,025 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:15:53,025 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'user', 'view-profile', 'manage-account']
INFO 2025-08-06 08:15:53,034 basehttp 77133 123145418715136 "GET /documents/ HTTP/1.1" 200 23547
INFO 2025-08-06 08:15:58,670 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:15:58,670 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'user', 'view-profile', 'manage-account']
INFO 2025-08-06 08:15:58,670 views 77133 123145418715136 [] User: john_doe, Roles: ['manage-account-links', 'user', 'view-profile', 'manage-account'], Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:15:58,710 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 08:15:58,716 views 77133 123145418715136 [] Access denied - User: john_doe, Action: view, Document: doc_marketing_001
INFO 2025-08-06 08:15:58,718 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:15:58,718 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'user', 'view-profile', 'manage-account']
WARNING 2025-08-06 08:15:58,722 log 77133 123145418715136 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-06 08:15:58,725 basehttp 77133 123145418715136 "GET /doc_marketing_001/view/ HTTP/1.1" 403 8287
INFO 2025-08-06 08:26:38,825 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:26:38,827 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'user', 'view-profile', 'manage-account']
INFO 2025-08-06 08:26:38,828 views 77133 123145418715136 [] User: john_doe, Roles: ['manage-account-links', 'user', 'view-profile', 'manage-account'], Action: delete, Document: doc_marketing_001
INFO 2025-08-06 08:26:38,871 _client 77133 123145418715136 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 08:26:38,875 views 77133 123145418715136 [] Access denied - User: john_doe, Action: delete, Document: doc_marketing_001
INFO 2025-08-06 08:26:38,876 utils 77133 123145418715136 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:26:38,909 utils 77133 123145418715136 [SESSION] Extracted roles: ['manage-account-links', 'user', 'view-profile', 'manage-account']
WARNING 2025-08-06 08:26:38,918 log 77133 123145418715136 Forbidden: /doc_marketing_001/delete/
WARNING 2025-08-06 08:26:38,919 basehttp 77133 123145418715136 "GET /doc_marketing_001/delete/ HTTP/1.1" 403 8287
INFO 2025-08-06 08:32:08,784 autoreload 77133 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 08:32:10,542 autoreload 77823 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:32:33,572 autoreload 77823 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 08:32:34,638 autoreload 77837 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:35:11,703 autoreload 77837 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 08:35:13,294 autoreload 77942 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:35:52,609 autoreload 77942 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/django_cerbos_keycloak/settings.py changed, reloading.
INFO 2025-08-06 08:35:54,046 autoreload 77961 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:36:00,935 autoreload 77961 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/django_cerbos_keycloak/settings.py changed, reloading.
INFO 2025-08-06 08:36:02,363 autoreload 77966 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:36:27,463 autoreload 77966 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/django_cerbos_keycloak/settings.py changed, reloading.
INFO 2025-08-06 08:36:29,302 autoreload 77982 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:50:11,689 autoreload 77982 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 08:50:14,878 autoreload 78437 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:51:05,947 basehttp 78437 123145579040768 "GET / HTTP/1.1" 200 25808
INFO 2025-08-06 08:51:18,100 basehttp 78437 123145579040768 "GET / HTTP/1.1" 200 25808
INFO 2025-08-06 08:51:27,055 basehttp 78437 123145579040768 "GET / HTTP/1.1" 200 24743
INFO 2025-08-06 08:51:48,731 basehttp 78437 123145579040768 "GET / HTTP/1.1" 200 24743
INFO 2025-08-06 08:52:36,976 basehttp 78437 123145579040768 "GET / HTTP/1.1" 200 24743
INFO 2025-08-06 08:52:37,564 basehttp 78437 123145579040768 "GET / HTTP/1.1" 200 24743
INFO 2025-08-06 08:52:38,026 basehttp 78437 123145579040768 "GET / HTTP/1.1" 200 24743
INFO 2025-08-06 08:52:38,186 basehttp 78437 123145579040768 "GET / HTTP/1.1" 200 24743
INFO 2025-08-06 08:53:01,683 basehttp 78437 123145579040768 "GET /doc123/view/ HTTP/1.1" 302 0
INFO 2025-08-06 08:53:01,801 basehttp 78437 123145579040768 "GET /accounts/login/?next=/doc123/view/ HTTP/1.1" 200 2605
INFO 2025-08-06 08:53:04,163 basehttp 78437 123145579040768 "GET /accounts/oidc/keycloak/login/?process=login&next=%2Fdoc123%2Fview%2F HTTP/1.1" 200 1416
INFO 2025-08-06 08:53:05,386 basehttp 78437 123145579040768 "POST /accounts/oidc/keycloak/login/?process=login&next=%2Fdoc123%2Fview%2F HTTP/1.1" 302 0
INFO 2025-08-06 08:53:11,331 basehttp 78437 123145579040768 "GET /accounts/oidc/keycloak/login/callback/?state=5Xxnvz356pOzQsZk&session_state=e06626c6-c741-41a4-82a0-85e8fe234c4e&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=6ed7ddb7-7484-4071-a69b-6772ffacf66d.e06626c6-c741-41a4-82a0-85e8fe234c4e.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 08:53:11,338 utils 78437 123145579040768 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'resource_access': {'django-client': {'roles': ['user']}, 'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'family_name': 'Doe', 'email': 'john@example.com'}
INFO 2025-08-06 08:53:11,339 utils 78437 123145579040768 [SESSION] Extracted roles: ['user', 'manage-account', 'manage-account-links', 'view-profile']
INFO 2025-08-06 08:53:11,339 views 78437 123145579040768 [] Authorization Check:
INFO 2025-08-06 08:53:11,340 views 78437 123145579040768     User: john_doe | Roles: ['view-profile', 'manage-account-links', 'manage-account', 'user']
INFO 2025-08-06 08:53:11,340 views 78437 123145579040768     Action: view | Document: doc123
INFO 2025-08-06 08:53:11,340 views 78437 123145579040768     Department: General
INFO 2025-08-06 08:53:11,340 views 78437 123145579040768     Status: draft
INFO 2025-08-06 08:53:11,340 views 78437 123145579040768     Confidential: False
INFO 2025-08-06 08:53:11,375 _client 78437 123145579040768 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 08:53:11,378 views 78437 123145579040768 [] DENIED: john_doe cannot view doc123
WARNING 2025-08-06 08:53:11,382 log 78437 123145579040768 Forbidden: /doc123/view/
WARNING 2025-08-06 08:53:11,383 basehttp 78437 123145579040768 "GET /doc123/view/ HTTP/1.1" 403 69
INFO 2025-08-06 08:53:14,417 basehttp 78437 123145579040768 "GET /accounts/oidc/keycloak/login/callback/?state=5Xxnvz356pOzQsZk&session_state=e06626c6-c741-41a4-82a0-85e8fe234c4e&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=017f46f8-6862-45fd-86fd-f5c4f7115588.e06626c6-c741-41a4-82a0-85e8fe234c4e.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 200 1909
INFO 2025-08-06 08:53:30,854 basehttp 78437 123145612619776 "GET / HTTP/1.1" 200 24743
WARNING 2025-08-06 08:53:44,135 log 78437 123145612619776 Not Found: /.well-known/appspecific/com.chrome.devtools.json
WARNING 2025-08-06 08:53:44,137 basehttp 78437 123145612619776 "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 3015
INFO 2025-08-06 08:54:34,603 basehttp 78437 123145579040768 "GET / HTTP/1.1" 200 24743
WARNING 2025-08-06 08:54:34,695 log 78437 123145579040768 Not Found: /.well-known/appspecific/com.chrome.devtools.json
WARNING 2025-08-06 08:54:34,696 basehttp 78437 123145579040768 "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 3015
INFO 2025-08-06 08:55:28,337 autoreload 78437 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/django_cerbos_keycloak/settings.py changed, reloading.
INFO 2025-08-06 08:55:30,139 autoreload 78617 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 08:55:38,245 basehttp 78617 123145348837376 "GET / HTTP/1.1" 200 24743
INFO 2025-08-06 08:55:41,496 basehttp 78617 123145348837376 "GET / HTTP/1.1" 200 24743
INFO 2025-08-06 08:59:59,799 autoreload 78617 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/django_cerbos_keycloak/settings.py changed, reloading.
INFO 2025-08-06 09:00:01,235 autoreload 78788 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:01:22,058 autoreload 78788 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:01:25,017 autoreload 78842 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:01:34,342 autoreload 78842 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:01:35,815 autoreload 78853 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:19:56,561 autoreload 78853 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/urls.py changed, reloading.
INFO 2025-08-06 09:19:59,228 autoreload 79473 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:20:13,068 basehttp 79473 123145340215296 "GET / HTTP/1.1" 200 10047
INFO 2025-08-06 09:20:14,549 basehttp 79473 123145340215296 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-06 09:20:15,716 basehttp 79473 123145340215296 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 09:20:16,750 basehttp 79473 123145340215296 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 09:20:22,011 basehttp 79473 123145340215296 "GET /accounts/oidc/keycloak/login/callback/?state=HJmk9sodZj5rRDCM&session_state=39c3d4e5-6dfe-4d55-8202-300cadb3c14a&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=54a36d91-fe8e-433b-ac68-e3756d82a8eb.39c3d4e5-6dfe-4d55-8202-300cadb3c14a.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 09:20:22,026 basehttp 79473 123145340215296 "GET /documents/ HTTP/1.1" 200 20472
INFO 2025-08-06 09:20:41,163 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:20:41,164 utils 79473 123145340215296 [SESSION] Extracted roles: ['view-profile', 'manage-account', 'manage-account-links']
INFO 2025-08-06 09:20:41,315 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 09:20:41,324 log 79473 123145340215296 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-06 09:20:41,325 basehttp 79473 123145340215296 "GET /doc_marketing_001/view/ HTTP/1.1" 403 115
INFO 2025-08-06 09:20:56,362 basehttp 79473 123145340215296 "GET /documents/ HTTP/1.1" 200 20472
INFO 2025-08-06 09:21:01,984 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:21:01,984 utils 79473 123145340215296 [SESSION] Extracted roles: ['view-profile', 'manage-account', 'manage-account-links']
INFO 2025-08-06 09:21:01,998 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 09:21:02,003 log 79473 123145340215296 Forbidden: /doc_hr_001/view/
WARNING 2025-08-06 09:21:02,004 basehttp 79473 123145340215296 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-06 09:22:16,010 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:22:16,012 utils 79473 123145340215296 [SESSION] Extracted roles: ['view-profile', 'manage-account', 'manage-account-links']
INFO 2025-08-06 09:22:16,034 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 09:22:16,043 log 79473 123145340215296 Forbidden: /doc_hr_001/view/
WARNING 2025-08-06 09:22:16,044 basehttp 79473 123145340215296 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-06 09:22:21,877 basehttp 79473 123145340215296 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 09:22:23,121 basehttp 79473 123145340215296 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 09:22:23,128 basehttp 79473 123145340215296 "GET / HTTP/1.1" 200 10047
INFO 2025-08-06 09:22:27,376 basehttp 79473 123145340215296 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 09:22:28,719 basehttp 79473 123145340215296 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 09:22:29,749 basehttp 79473 123145340215296 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 09:22:29,983 basehttp 79473 123145340215296 "GET /accounts/oidc/keycloak/login/callback/?state=JXHHb4nyJaJdESpR&session_state=39c3d4e5-6dfe-4d55-8202-300cadb3c14a&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=3284b7c0-97c5-495a-ab22-e29a1dba60fc.39c3d4e5-6dfe-4d55-8202-300cadb3c14a.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 09:22:30,007 basehttp 79473 123145340215296 "GET /documents/ HTTP/1.1" 200 20472
INFO 2025-08-06 09:22:36,002 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:22:36,003 utils 79473 123145340215296 [SESSION] Extracted roles: ['view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 09:22:36,031 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 09:22:36,038 basehttp 79473 123145340215296 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-06 09:22:46,252 basehttp 79473 123145340215296 "GET / HTTP/1.1" 200 20472
INFO 2025-08-06 09:22:47,368 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:22:47,368 utils 79473 123145340215296 [SESSION] Extracted roles: ['view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 09:22:47,399 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 09:22:47,404 log 79473 123145340215296 Forbidden: /doc_finance_001/view/
WARNING 2025-08-06 09:22:47,404 basehttp 79473 123145340215296 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-06 09:22:51,971 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:22:51,971 utils 79473 123145340215296 [SESSION] Extracted roles: ['view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 09:22:51,999 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 09:22:52,004 log 79473 123145340215296 Forbidden: /doc_hr_001/view/
WARNING 2025-08-06 09:22:52,005 basehttp 79473 123145340215296 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-06 09:23:16,790 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:23:16,790 utils 79473 123145340215296 [SESSION] Extracted roles: ['view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 09:23:16,858 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 09:23:16,868 basehttp 79473 123145340215296 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-06 09:23:36,772 basehttp 79473 123145340215296 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 09:23:37,693 basehttp 79473 123145340215296 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 09:23:37,697 basehttp 79473 123145340215296 "GET / HTTP/1.1" 200 10047
INFO 2025-08-06 09:23:38,427 basehttp 79473 123145340215296 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 09:23:39,610 basehttp 79473 123145340215296 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 09:23:40,641 basehttp 79473 123145340215296 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 09:23:40,819 basehttp 79473 123145340215296 "GET /accounts/oidc/keycloak/login/callback/?state=A9RtcBNhRP3b67ie&session_state=39c3d4e5-6dfe-4d55-8202-300cadb3c14a&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=f60990d5-a94a-4079-beee-51fdad3839a6.39c3d4e5-6dfe-4d55-8202-300cadb3c14a.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 09:23:40,832 basehttp 79473 123145340215296 "GET /documents/ HTTP/1.1" 200 20472
INFO 2025-08-06 09:23:48,020 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:23:48,021 utils 79473 123145340215296 [SESSION] Extracted roles: ['admin', 'view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 09:23:48,078 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 09:23:48,084 basehttp 79473 123145340215296 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-06 09:23:50,353 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:23:50,354 utils 79473 123145340215296 [SESSION] Extracted roles: ['admin', 'view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 09:23:50,369 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 09:23:50,381 basehttp 79473 123145340215296 "GET /doc_hr_001/view/ HTTP/1.1" 200 1458
INFO 2025-08-06 09:23:51,626 basehttp 79473 123145340215296 "GET / HTTP/1.1" 200 20472
INFO 2025-08-06 09:23:52,552 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:23:52,552 utils 79473 123145340215296 [SESSION] Extracted roles: ['admin', 'view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 09:23:52,570 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 09:23:52,583 basehttp 79473 123145340215296 "GET /doc_hr_001/edit/ HTTP/1.1" 200 2102
INFO 2025-08-06 09:23:58,550 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:23:58,551 utils 79473 123145340215296 [SESSION] Extracted roles: ['admin', 'view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 09:23:58,613 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-06 09:23:58,636 log 79473 123145340215296 Forbidden: /doc_hr_001/approve/
WARNING 2025-08-06 09:23:58,636 basehttp 79473 123145340215296 "GET /doc_hr_001/approve/ HTTP/1.1" 403 112
INFO 2025-08-06 09:24:03,807 utils 79473 123145340215296 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-06 09:24:03,809 utils 79473 123145340215296 [SESSION] Extracted roles: ['admin', 'view-profile', 'manage-account', 'manage-account-links', 'user']
INFO 2025-08-06 09:24:03,831 _client 79473 123145340215296 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-06 09:24:03,838 basehttp 79473 123145340215296 "GET /doc_marketing_001/approve/ HTTP/1.1" 200 1341
INFO 2025-08-06 09:24:06,767 basehttp 79473 123145340215296 "GET / HTTP/1.1" 200 20472
INFO 2025-08-06 09:24:12,775 basehttp 79473 123145340215296 "GET / HTTP/1.1" 200 20472
INFO 2025-08-06 09:24:22,032 basehttp 79473 123145340215296 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 09:24:34,452 autoreload 79473 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:24:35,723 autoreload 79642 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:25:58,928 autoreload 79642 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-06 09:26:00,157 autoreload 79684 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:27:18,722 basehttp 79684 123145372020736 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 09:27:18,785 basehttp 79684 123145372020736 "GET / HTTP/1.1" 200 10047
INFO 2025-08-06 09:27:59,790 basehttp 79684 123145372020736 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 09:30:27,608 basehttp 79684 123145372020736 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-06 09:30:30,074 basehttp 79684 123145372020736 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 09:30:33,143 basehttp 79684 123145372020736 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 09:30:33,428 basehttp 79684 123145372020736 "GET /accounts/oidc/keycloak/login/callback/?state=8SQ8mLaLpsDPMwk1&session_state=39c3d4e5-6dfe-4d55-8202-300cadb3c14a&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=c5af84a4-29d4-42c4-a04c-054329b195e5.39c3d4e5-6dfe-4d55-8202-300cadb3c14a.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 09:30:33,441 basehttp 79684 123145372020736 "GET /documents/ HTTP/1.1" 200 20472
INFO 2025-08-06 09:30:36,709 basehttp 79684 123145372020736 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 09:30:39,704 basehttp 79684 123145372020736 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 09:30:39,709 basehttp 79684 123145372020736 "GET / HTTP/1.1" 200 10047
INFO 2025-08-06 09:37:28,905 autoreload 79684 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:37:31,053 autoreload 80149 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:37:36,260 basehttp 80149 123145581314048 "GET / HTTP/1.1" 302 0
WARNING 2025-08-06 09:37:36,359 log 80149 123145581314048 Not Found: /accounts/keycloak/login/
WARNING 2025-08-06 09:37:36,360 basehttp 80149 123145581314048 "GET /accounts/keycloak/login/ HTTP/1.1" 404 7463
INFO 2025-08-06 09:38:11,444 autoreload 80149 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:38:12,984 autoreload 80172 140704330349056 Watching for file changes with StatReloader
WARNING 2025-08-06 09:38:14,557 log 80172 123145524068352 Not Found: /accounts/keycloak/login/
WARNING 2025-08-06 09:38:14,557 basehttp 80172 123145524068352 "GET /accounts/keycloak/login/ HTTP/1.1" 404 7463
INFO 2025-08-06 09:38:17,145 basehttp 80172 123145524068352 "GET / HTTP/1.1" 200 10047
INFO 2025-08-06 09:38:19,738 basehttp 80172 123145524068352 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 09:38:21,414 basehttp 80172 123145524068352 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 09:38:23,472 basehttp 80172 123145524068352 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 09:38:25,123 basehttp 80172 123145524068352 "GET /accounts/oidc/keycloak/login/callback/?state=eeSOkVkqi14fAmXc&session_state=39c3d4e5-6dfe-4d55-8202-300cadb3c14a&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=3d0a30dd-f771-46ec-af71-d38b3abf0ee4.39c3d4e5-6dfe-4d55-8202-300cadb3c14a.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-06 09:38:25,133 basehttp 80172 123145524068352 "GET /documents/ HTTP/1.1" 200 20472
INFO 2025-08-06 09:38:28,208 basehttp 80172 123145524068352 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-06 09:38:30,084 basehttp 80172 123145524068352 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-06 09:38:30,094 basehttp 80172 123145524068352 "GET / HTTP/1.1" 200 10047
INFO 2025-08-06 09:38:35,950 basehttp 80172 123145524068352 "GET / HTTP/1.1" 200 10047
INFO 2025-08-06 09:38:36,927 basehttp 80172 123145524068352 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-06 09:38:38,211 basehttp 80172 123145524068352 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 09:38:39,514 basehttp 80172 123145524068352 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 09:38:51,140 basehttp 80172 123145524068352 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 09:38:56,239 basehttp 80172 123145524068352 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-06 09:39:02,871 basehttp 80172 123145524068352 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-06 09:39:37,162 basehttp 80172 123145524068352 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 09:39:52,311 basehttp 80172 123145524068352 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-06 09:40:25,768 autoreload 80172 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:40:28,416 autoreload 80247 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:40:54,854 basehttp 80247 123145518907392 "GET / HTTP/1.1" 200 10140
INFO 2025-08-06 09:40:57,114 basehttp 80247 123145518907392 "GET /accounts/oidc/keycloak/login/ HTTP/1.1" 200 1416
INFO 2025-08-06 09:40:59,086 basehttp 80247 123145518907392 "POST /accounts/oidc/keycloak/login/ HTTP/1.1" 302 0
INFO 2025-08-06 09:41:49,669 basehttp 80247 123145518907392 "GET / HTTP/1.1" 200 10136
INFO 2025-08-06 09:41:55,470 basehttp 80247 123145518907392 "GET /accounts/oidc/keycloak/login/ HTTP/1.1" 200 1416
INFO 2025-08-06 09:42:01,052 basehttp 80247 123145518907392 "POST /accounts/oidc/keycloak/login/ HTTP/1.1" 302 0
INFO 2025-08-06 09:42:33,350 basehttp 80247 123145518907392 "GET / HTTP/1.1" 200 10136
INFO 2025-08-06 09:42:35,406 basehttp 80247 123145518907392 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-06 09:43:49,282 autoreload 80247 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:43:50,609 autoreload 80372 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:43:53,976 autoreload 80372 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:43:54,975 autoreload 80377 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:43:57,903 autoreload 80377 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:43:58,816 autoreload 80379 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:44:02,081 basehttp 80379 123145346048000 "GET / HTTP/1.1" 302 0
INFO 2025-08-06 09:44:02,126 basehttp 80379 123145346048000 "GET /accounts/oidc/keycloak/login/ HTTP/1.1" 200 1416
INFO 2025-08-06 09:44:02,436 basehttp 80379 123145346048000 "GET /accounts/oidc/keycloak/login/ HTTP/1.1" 200 1416
INFO 2025-08-06 09:44:03,550 basehttp 80379 123145346048000 "GET /accounts/oidc/keycloak/login/ HTTP/1.1" 200 1416
INFO 2025-08-06 09:44:11,270 basehttp 80379 123145346048000 "GET / HTTP/1.1" 302 0
INFO 2025-08-06 09:44:11,283 basehttp 80379 123145346048000 "GET /accounts/oidc/keycloak/login/ HTTP/1.1" 200 1416
INFO 2025-08-06 09:44:40,908 autoreload 80379 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-06 09:44:43,630 autoreload 80408 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-06 09:45:48,105 basehttp 80408 123145349517312 "GET / HTTP/1.1" 200 10136
INFO 2025-08-06 09:45:57,745 basehttp 80408 123145349517312 "GET /accounts/oidc/keycloak/login/ HTTP/1.1" 200 1416
INFO 2025-08-06 09:46:22,651 basehttp 80408 123145349517312 "GET / HTTP/1.1" 200 10136
INFO 2025-08-06 10:40:09,123 basehttp 80408 123145349517312 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-06 10:40:10,813 basehttp 80408 123145349517312 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-06 10:40:13,025 basehttp 80408 123145349517312 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 01:55:40,995 basehttp 80408 123145349517312 "GET / HTTP/1.1" 200 10136
INFO 2025-08-07 01:55:55,145 basehttp 80408 123145349517312 "GET /accounts/login/ HTTP/1.1" 200 2496
INFO 2025-08-07 01:55:57,028 basehttp 80408 123145349517312 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 01:55:59,380 basehttp 80408 123145349517312 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 01:56:07,620 basehttp 80408 123145349517312 "GET /accounts/oidc/keycloak/login/callback/?state=0sgu6r4xM66tNypK&session_state=16e268af-275e-4a96-a9e3-541cf826dcb2&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=0edc93f9-5cab-488e-be2e-5edc4a56e66d.16e268af-275e-4a96-a9e3-541cf826dcb2.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 01:56:07,679 basehttp 80408 123145349517312 "GET /documents/ HTTP/1.1" 200 20472
INFO 2025-08-07 01:56:26,414 utils 80408 123145349517312 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-07 01:56:26,415 utils 80408 123145349517312 [SESSION] Extracted roles: ['manage-account-links', 'manage-account', 'user', 'view-profile', 'admin']
INFO 2025-08-07 01:56:26,604 _client 80408 123145349517312 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 01:56:26,615 basehttp 80408 123145349517312 "GET /doc_finance_001/view/ HTTP/1.1" 200 1473
WARNING 2025-08-07 01:59:23,067 log 80408 123145349517312 Not Found: /.well-known/appspecific/com.chrome.devtools.json
WARNING 2025-08-07 01:59:23,069 basehttp 80408 123145349517312 "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 2830
INFO 2025-08-07 02:06:27,437 autoreload 80408 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-07 02:06:29,147 autoreload 84948 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:06:55,291 autoreload 84948 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-07 02:06:56,076 autoreload 84959 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:07:04,777 utils 84959 123145485860864 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-07 02:07:04,777 utils 84959 123145485860864 [SESSION] Extracted roles: ['view-profile', 'user', 'admin', 'manage-account-links', 'manage-account']
INFO 2025-08-07 02:07:04,778 utils 84959 123145485860864 [SESSION] Raw id_token: None
INFO 2025-08-07 02:07:04,792 _client 84959 123145485860864 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 02:07:04,797 basehttp 84959 123145485860864 "GET /doc_finance_001/view/ HTTP/1.1" 200 1473
INFO 2025-08-07 02:10:32,216 autoreload 84959 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-07 02:10:34,703 autoreload 85078 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:38:45,430 autoreload 85078 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-07 02:38:47,551 autoreload 86026 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:39:20,293 autoreload 86026 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 02:39:22,220 autoreload 86055 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:51:00,084 autoreload 86055 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 02:51:02,033 autoreload 86445 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:51:05,003 autoreload 86445 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 02:51:06,084 autoreload 86451 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:52:09,720 autoreload 86451 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-07 02:52:11,483 autoreload 86510 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:52:14,375 autoreload 86510 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 02:52:15,655 autoreload 86543 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:52:33,389 autoreload 86543 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 02:52:34,564 autoreload 86557 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:52:48,028 basehttp 86557 123145514696704 "GET / HTTP/1.1" 200 20472
INFO 2025-08-07 02:52:51,784 utils 86557 123145514696704 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-07 02:52:51,784 utils 86557 123145514696704 [SESSION] Extracted roles: ['admin', 'manage-account', 'view-profile', 'manage-account-links', 'user']
INFO 2025-08-07 02:52:51,784 utils 86557 123145514696704 [SESSION] Extracted attrs: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 02:52:51,786 utils 86557 123145514696704 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-07 02:52:51,787 utils 86557 123145514696704 [SESSION] Extracted roles: ['admin', 'manage-account', 'view-profile', 'manage-account-links', 'user']
INFO 2025-08-07 02:52:51,787 utils 86557 123145514696704 [SESSION] Extracted attrs: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 02:52:51,789 utils 86557 123145514696704 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-07 02:52:51,789 utils 86557 123145514696704 [SESSION] Extracted roles: ['admin', 'manage-account', 'view-profile', 'manage-account-links', 'user']
INFO 2025-08-07 02:52:51,790 utils 86557 123145514696704 [SESSION] Extracted attrs: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 02:52:51,792 utils 86557 123145514696704 [SESSION] Extra data: {'sub': '2668d9dd-0fef-4091-8dc8-c0514ad875e9', 'seniority_level': 'mid', 'resource_access': {'account': {'roles': ['manage-account', 'manage-account-links', 'view-profile']}}, 'email_verified': True, 'realm_access': {'roles': ['default-roles-django-app', 'offline_access', 'admin', 'uma_authorization', 'user']}, 'name': 'John Doe', 'preferred_username': 'john_doe', 'given_name': 'John', 'department': 'Marketing', 'family_name': 'Doe', 'email': 'john.doe@company.com'}
INFO 2025-08-07 02:52:51,792 utils 86557 123145514696704 [SESSION] Extracted roles: ['admin', 'manage-account', 'view-profile', 'manage-account-links', 'user']
INFO 2025-08-07 02:52:51,792 utils 86557 123145514696704 [SESSION] Extracted attrs: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 02:52:51,862 _client 86557 123145514696704 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 02:52:51,869 basehttp 86557 123145514696704 "GET /doc_hr_001/view/ HTTP/1.1" 200 1458
INFO 2025-08-07 02:53:43,872 autoreload 86557 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 02:53:45,014 autoreload 86597 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 02:58:55,213 autoreload 86597 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/utils.py changed, reloading.
INFO 2025-08-07 02:58:58,322 autoreload 86763 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:00:20,956 autoreload 86763 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:00:23,432 autoreload 86816 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:01:17,575 autoreload 86816 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:01:19,284 autoreload 86837 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:01:29,981 basehttp 86837 123145478701056 "GET / HTTP/1.1" 200 20472
INFO 2025-08-07 03:01:34,017 _client 86837 123145478701056 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 03:01:34,026 basehttp 86837 123145478701056 "GET /doc_it_001/view/ HTTP/1.1" 200 1459
INFO 2025-08-07 03:03:29,554 autoreload 86837 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:03:30,730 autoreload 86917 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:04:02,253 autoreload 86917 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:04:03,824 autoreload 86938 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:04:26,934 autoreload 86938 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:04:28,568 autoreload 86956 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:04:33,700 autoreload 86956 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:04:35,015 autoreload 86963 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:04:42,416 basehttp 86963 123145460211712 "GET / HTTP/1.1" 200 20472
INFO 2025-08-07 03:04:45,094 views 86963 123145460211712 [SESSION] Final roles for user john_doe: ['admin', 'manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 03:04:45,095 views 86963 123145460211712 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 03:04:45,178 _client 86963 123145460211712 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 03:04:45,188 basehttp 86963 123145460211712 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 03:05:04,915 autoreload 86963 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:05:06,312 autoreload 86979 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:08:39,018 autoreload 86979 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:08:40,589 autoreload 87084 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:08:42,934 autoreload 87084 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:08:44,547 autoreload 87091 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:08:49,585 autoreload 87091 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:08:50,488 autoreload 87101 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:13:45,669 autoreload 87101 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:13:47,129 autoreload 87257 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:14:32,955 autoreload 87257 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:14:34,506 autoreload 87287 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:14:58,410 autoreload 87287 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:15:00,469 autoreload 87308 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:15:09,383 autoreload 87308 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:15:10,430 autoreload 87314 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:15:30,215 basehttp 87314 123145373110272 "GET / HTTP/1.1" 200 20472
INFO 2025-08-07 03:15:40,500 basehttp 87314 123145373110272 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-07 03:15:42,469 basehttp 87314 123145373110272 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 03:15:42,475 basehttp 87314 123145373110272 "GET / HTTP/1.1" 200 10136
INFO 2025-08-07 03:15:44,300 basehttp 87314 123145373110272 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 03:15:50,232 basehttp 87314 123145373110272 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 03:15:52,341 basehttp 87314 123145373110272 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 03:16:09,918 basehttp 87314 123145373110272 "GET /accounts/oidc/keycloak/login/callback/?state=GK4rZSG68BV67kpj&session_state=07502e68-41d6-4321-ad54-a62865af4b15&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=05c6c1db-8d06-4eb1-84ce-ad3bc514cee2.07502e68-41d6-4321-ad54-a62865af4b15.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 03:16:09,937 basehttp 87314 123145373110272 "GET /documents/ HTTP/1.1" 200 20472
INFO 2025-08-07 03:16:16,576 views 87314 123145373110272 [SESSION] Final roles for user john_doe: ['manage-account-links', 'view-profile', 'manage-account', 'admin', 'user']
INFO 2025-08-07 03:16:16,577 views 87314 123145373110272 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 03:16:16,603 _client 87314 123145373110272 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 03:16:16,612 basehttp 87314 123145373110272 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 03:18:49,058 autoreload 87314 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:18:51,024 autoreload 87415 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:19:29,927 autoreload 87415 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:19:31,220 autoreload 87451 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:19:37,017 views 87451 123145368850432 [SESSION] Final roles for user john_doe: ['manage-account', 'user', 'view-profile', 'admin', 'manage-account-links']
INFO 2025-08-07 03:19:37,017 views 87451 123145368850432 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 03:19:37,027 views 87451 123145368850432 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'admin', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 03:19:37,027 views 87451 123145368850432 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 03:19:37,028 views 87451 123145368850432 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 03:19:37,046 _client 87451 123145368850432 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 03:19:37,055 basehttp 87451 123145368850432 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 03:39:09,635 autoreload 87451 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 03:39:11,051 autoreload 88070 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 03:39:23,489 views 88070 123145553522688 [SESSION] Final roles for user john_doe: ['manage-account-links', 'user', 'admin', 'manage-account', 'view-profile']
INFO 2025-08-07 03:39:23,489 views 88070 123145553522688 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 03:39:23,495 views 88070 123145553522688 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account-links', 'user', 'admin', 'manage-account', 'view-profile'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 03:39:23,496 views 88070 123145553522688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 03:39:23,496 views 88070 123145553522688 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 03:39:23,621 _client 88070 123145553522688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 03:39:23,635 basehttp 88070 123145553522688 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 03:50:20,689 basehttp 88070 123145553522688 "GET / HTTP/1.1" 200 20472
INFO 2025-08-07 03:50:23,414 views 88070 123145553522688 [SESSION] Final roles for user john_doe: ['manage-account-links', 'user', 'admin', 'manage-account', 'view-profile']
INFO 2025-08-07 03:50:23,414 views 88070 123145553522688 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 03:50:23,423 views 88070 123145553522688 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account-links', 'user', 'admin', 'manage-account', 'view-profile'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 03:50:23,423 views 88070 123145553522688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 03:50:23,425 views 88070 123145553522688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 03:50:23,441 _client 88070 123145553522688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 03:50:23,446 basehttp 88070 123145553522688 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 03:50:38,071 basehttp 88070 123145553522688 "GET / HTTP/1.1" 200 20472
INFO 2025-08-07 03:51:51,182 basehttp 88070 123145553522688 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-07 03:51:52,016 basehttp 88070 123145553522688 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 03:51:52,021 basehttp 88070 123145553522688 "GET / HTTP/1.1" 200 10136
INFO 2025-08-07 03:51:52,891 basehttp 88070 123145553522688 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 03:51:54,234 basehttp 88070 123145553522688 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 03:51:55,403 basehttp 88070 123145553522688 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 03:52:06,191 basehttp 88070 123145553522688 "GET /accounts/oidc/keycloak/login/callback/?state=A6JP8RKWbM1g7Q25&session_state=8b597931-924d-4440-a40c-c33a49510e05&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=42822e83-e792-4b7c-8fef-62cd8660edc9.8b597931-924d-4440-a40c-c33a49510e05.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 03:52:06,203 basehttp 88070 123145553522688 "GET /documents/ HTTP/1.1" 200 20472
INFO 2025-08-07 03:52:15,897 views 88070 123145553522688 [SESSION] Final roles for user john_doe: ['manage-account-links', 'user', 'admin', 'manage-account', 'view-profile']
INFO 2025-08-07 03:52:15,897 views 88070 123145553522688 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 03:52:15,904 views 88070 123145553522688 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account-links', 'user', 'admin', 'manage-account', 'view-profile'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 03:52:15,905 views 88070 123145553522688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 03:52:15,905 views 88070 123145553522688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 03:52:15,930 _client 88070 123145553522688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 03:52:15,940 basehttp 88070 123145553522688 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 03:53:38,307 basehttp 88070 123145553522688 "GET / HTTP/1.1" 200 20472
INFO 2025-08-07 03:53:39,879 views 88070 123145553522688 [SESSION] Final roles for user john_doe: ['manage-account-links', 'user', 'admin', 'manage-account', 'view-profile']
INFO 2025-08-07 03:53:39,880 views 88070 123145553522688 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': None}
INFO 2025-08-07 03:53:39,898 views 88070 123145553522688 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account-links', 'user', 'admin', 'manage-account', 'view-profile'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 03:53:39,918 views 88070 123145553522688 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 03:53:39,919 views 88070 123145553522688 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 03:53:39,962 _client 88070 123145553522688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 03:53:39,976 basehttp 88070 123145553522688 "GET /doc_finance_001/edit/ HTTP/1.1" 200 2107
INFO 2025-08-07 03:54:01,136 basehttp 88070 123145553522688 "GET / HTTP/1.1" 200 20472
INFO 2025-08-07 06:54:19,441 basehttp 88070 123145553522688 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-07 06:54:21,461 basehttp 88070 123145553522688 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 06:54:21,469 basehttp 88070 123145553522688 "GET / HTTP/1.1" 200 10136
INFO 2025-08-07 06:54:24,700 basehttp 88070 123145553522688 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 06:54:26,421 basehttp 88070 123145553522688 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 06:54:29,323 basehttp 88070 123145553522688 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 06:55:06,810 basehttp 88070 123145553522688 "GET /accounts/oidc/keycloak/login/callback/?state=mHcHprHJZGWHIdoL&session_state=d719b9e3-cda3-4cd8-a0b2-7d264226a515&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=54434d4b-fba3-4078-abde-708f452ac621.d719b9e3-cda3-4cd8-a0b2-7d264226a515.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 06:55:06,825 basehttp 88070 123145553522688 "GET /documents/ HTTP/1.1" 200 20481
INFO 2025-08-07 06:55:16,101 views 88070 123145553522688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'user', 'manage-account', 'view-profile']
INFO 2025-08-07 06:55:16,101 views 88070 123145553522688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 06:55:16,117 views 88070 123145553522688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'user', 'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 06:55:16,118 views 88070 123145553522688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 06:55:16,118 views 88070 123145553522688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 06:55:16,204 _client 88070 123145553522688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 06:55:16,218 log 88070 123145553522688 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-07 06:55:16,218 basehttp 88070 123145553522688 "GET /doc_marketing_001/view/ HTTP/1.1" 403 115
ERROR 2025-08-07 07:16:54,348 log 88070 123145553522688 Internal Server Error: /documents/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 21, in home
    return render(request, 'documents/home.html', context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 33, in get_template
    return Template(self.engine.get_template(template_name), self)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/engine.py", line 175, in get_template
    template, origin = self.find_template(template_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/engine.py", line 157, in find_template
    template = loader.get_template(name, skip=skip)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 200, in compile_nodelist
    return parser.parse()
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 513, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 511, in parse
    compiled_result = compile_func(self, token)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 953, in do_if
    nodelist = parser.parse(("elif", "else", "endif"))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 513, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 511, in parse
    compiled_result = compile_func(self, token)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 853, in do_for
    nodelist_loop = parser.parse(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 484, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 482, in parse
    filter_expression = self.compile_filter(token.contents)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 600, in compile_filter
    return FilterExpression(token, self)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 698, in __init__
    filter_func = parser.find_filter(filter_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 606, in find_filter
    raise TemplateSyntaxError("Invalid filter: '%s'" % filter_name)
django.template.exceptions.TemplateSyntaxError: Invalid filter: 'replace'
ERROR 2025-08-07 07:16:54,384 basehttp 88070 123145553522688 "GET /documents/ HTTP/1.1" 500 244438
INFO 2025-08-07 07:17:47,324 basehttp 88070 123145553522688 "GET /documents/ HTTP/1.1" 200 13943
ERROR 2025-08-07 07:18:18,623 log 88070 123145553522688 Internal Server Error: /documents/
Traceback (most recent call last):
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "/Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py", line 21, in home
    return render(request, 'documents/home.html', context)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/shortcuts.py", line 24, in render
    content = loader.render_to_string(template_name, context, request, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/backends/django.py", line 33, in get_template
    return Template(self.engine.get_template(template_name), self)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/engine.py", line 175, in get_template
    template, origin = self.find_template(template_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/engine.py", line 157, in find_template
    template = loader.get_template(name, skip=skip)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 200, in compile_nodelist
    return parser.parse()
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 513, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 511, in parse
    compiled_result = compile_func(self, token)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 953, in do_if
    nodelist = parser.parse(("elif", "else", "endif"))
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 513, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 511, in parse
    compiled_result = compile_func(self, token)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/defaulttags.py", line 853, in do_for
    nodelist_loop = parser.parse(
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 484, in parse
    raise self.error(token, e)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 482, in parse
    filter_expression = self.compile_filter(token.contents)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 600, in compile_filter
    return FilterExpression(token, self)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 698, in __init__
    filter_func = parser.find_filter(filter_name)
  File "/Users/duy/Documents/test/venv/lib/python3.9/site-packages/django/template/base.py", line 606, in find_filter
    raise TemplateSyntaxError("Invalid filter: '%s'" % filter_name)
django.template.exceptions.TemplateSyntaxError: Invalid filter: 'replace'
ERROR 2025-08-07 07:18:18,627 basehttp 88070 123145553522688 "GET /documents/ HTTP/1.1" 500 244358
INFO 2025-08-07 07:21:04,562 basehttp 88070 123145553522688 "GET /documents/ HTTP/1.1" 200 16294
INFO 2025-08-07 07:21:14,764 views 88070 123145553522688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'user', 'manage-account', 'view-profile']
INFO 2025-08-07 07:21:14,764 views 88070 123145553522688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:21:14,774 views 88070 123145553522688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'user', 'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:21:14,774 views 88070 123145553522688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 15000, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:21:14,774 views 88070 123145553522688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:21:14,814 _client 88070 123145553522688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:21:14,822 log 88070 123145553522688 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:21:14,823 basehttp 88070 123145553522688 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:21:27,100 views 88070 123145553522688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'user', 'manage-account', 'view-profile']
INFO 2025-08-07 07:21:27,100 views 88070 123145553522688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:21:27,113 views 88070 123145553522688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'user', 'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:21:27,113 views 88070 123145553522688 [CERBOS][CHECK] Resource: Resource(id='doc_finance_002', kind='document', attr={'author': 'john_finance', 'status': 'pending_review', 'department': 'Finance', 'classification': 'restricted', 'project_budget': 5000, 'content_type': 'expense_report', 'created_at': '2025-01-06', 'title': 'Expense Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:21:27,113 views 88070 123145553522688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:21:27,130 _client 88070 123145553522688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:21:27,137 log 88070 123145553522688 Forbidden: /doc_finance_002/view/
WARNING 2025-08-07 07:21:27,138 basehttp 88070 123145553522688 "GET /doc_finance_002/view/ HTTP/1.1" 403 106
INFO 2025-08-07 07:21:35,129 views 88070 123145553522688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'user', 'manage-account', 'view-profile']
INFO 2025-08-07 07:21:35,130 views 88070 123145553522688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:21:35,138 views 88070 123145553522688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'user', 'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:21:35,138 views 88070 123145553522688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 15000, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:21:35,139 views 88070 123145553522688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:21:35,153 _client 88070 123145553522688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:21:35,158 log 88070 123145553522688 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:21:35,159 basehttp 88070 123145553522688 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:23:51,125 autoreload 88070 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/data.py changed, reloading.
INFO 2025-08-07 07:23:53,969 autoreload 93397 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 07:23:54,802 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:23:54,803 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:23:54,810 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:23:54,810 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:23:54,811 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:23:54,824 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:23:54,833 log 93397 123145450610688 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:23:54,834 basehttp 93397 123145450610688 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:23:56,523 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:23:56,523 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:23:56,530 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:23:56,530 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:23:56,530 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:23:56,545 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:23:56,549 log 93397 123145450610688 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:23:56,550 basehttp 93397 123145450610688 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:23:59,606 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:23:59,606 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:23:59,616 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:23:59,616 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:23:59,616 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:23:59,628 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:23:59,636 log 93397 123145450610688 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:23:59,637 basehttp 93397 123145450610688 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:24:06,091 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:24:06,092 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:24:06,103 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:24:06,103 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:24:06,103 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:24:06,115 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:24:06,120 log 93397 123145450610688 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:24:06,121 basehttp 93397 123145450610688 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:26:42,252 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:26:42,253 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:26:42,257 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:26:42,257 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:26:42,257 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:26:42,275 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:26:42,287 log 93397 123145450610688 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:26:42,289 basehttp 93397 123145450610688 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:26:45,121 basehttp 93397 123145450610688 "GET /documents/ HTTP/1.1" 200 25458
INFO 2025-08-07 07:26:48,046 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:26:48,047 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:26:48,055 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:26:48,055 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:26:48,055 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:26:48,084 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:26:48,091 log 93397 123145450610688 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:26:48,092 basehttp 93397 123145450610688 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:26:53,491 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:26:53,491 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:26:53,509 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:26:53,509 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_it_001', kind='document', attr={'author': 'it_admin', 'status': 'rejected', 'department': 'IT', 'classification': 'confidential', 'project_budget': 25000, 'content_type': 'security_policy', 'created_at': '2025-01-04', 'title': 'Security Policy', 'is_financial': False, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:26:53,509 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:26:53,534 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:26:53,543 log 93397 123145450610688 Forbidden: /doc_it_001/view/
WARNING 2025-08-07 07:26:53,549 basehttp 93397 123145450610688 "GET /doc_it_001/view/ HTTP/1.1" 403 107
INFO 2025-08-07 07:26:55,711 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:26:55,711 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:26:55,720 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:26:55,720 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_finance_002', kind='document', attr={'author': 'john_finance', 'status': 'pending_review', 'department': 'Finance', 'classification': 'restricted', 'project_budget': 5000, 'content_type': 'expense_report', 'created_at': '2025-01-06', 'title': 'Expense Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:26:55,721 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:26:55,741 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:26:55,750 log 93397 123145450610688 Forbidden: /doc_finance_002/view/
WARNING 2025-08-07 07:26:55,751 basehttp 93397 123145450610688 "GET /doc_finance_002/view/ HTTP/1.1" 403 106
INFO 2025-08-07 07:26:57,951 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:26:57,951 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:26:57,956 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:26:57,956 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:26:57,956 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:26:57,962 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:26:57,972 log 93397 123145450610688 Forbidden: /doc_hr_001/view/
WARNING 2025-08-07 07:26:57,973 basehttp 93397 123145450610688 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-07 07:27:00,310 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:27:00,310 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:27:00,321 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:27:00,322 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:27:00,322 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:27:00,338 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:27:00,343 log 93397 123145450610688 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 07:27:00,344 basehttp 93397 123145450610688 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:27:01,808 views 93397 123145450610688 [SESSION] Final roles for user intern_user: ['manage-account-links', 'manage-account', 'view-profile', 'user']
INFO 2025-08-07 07:27:01,808 views 93397 123145450610688 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:27:01,817 views 93397 123145450610688 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:27:01,818 views 93397 123145450610688 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:27:01,818 views 93397 123145450610688 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:27:01,855 _client 93397 123145450610688 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:27:01,859 log 93397 123145450610688 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-07 07:27:01,859 basehttp 93397 123145450610688 "GET /doc_marketing_001/view/ HTTP/1.1" 403 115
INFO 2025-08-07 07:28:38,524 autoreload 93397 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/views.py changed, reloading.
INFO 2025-08-07 07:28:40,744 autoreload 93565 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 07:29:31,891 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25636
INFO 2025-08-07 07:29:57,134 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25636
INFO 2025-08-07 07:30:14,199 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:30:14,200 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:30:14,214 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:30:14,214 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:30:14,215 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:30:14,233 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:30:14,245 log 93565 123145445961728 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-07 07:30:14,245 basehttp 93565 123145445961728 "GET /doc_marketing_001/view/ HTTP/1.1" 403 115
INFO 2025-08-07 07:30:34,239 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:30:34,249 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:30:34,291 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:30:34,323 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:30:34,323 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:30:34,363 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:30:34,370 log 93565 123145445961728 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:30:34,398 basehttp 93565 123145445961728 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:31:18,477 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:31:18,479 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': None}
INFO 2025-08-07 07:31:18,482 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:31:18,483 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:31:18,483 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:31:18,501 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:31:18,507 log 93565 123145445961728 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:31:18,508 basehttp 93565 123145445961728 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:40:25,907 basehttp 93565 123145445961728 "GET /accounts/logout/ HTTP/1.1" 200 2179
INFO 2025-08-07 07:40:26,909 basehttp 93565 123145445961728 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 07:40:26,916 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 07:40:27,859 basehttp 93565 123145445961728 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 07:40:33,336 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 07:40:34,694 basehttp 93565 123145445961728 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 07:40:40,020 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/callback/?state=8dOV02nSSKieNcqb&session_state=37aaf52a-a3c1-4383-a6f9-f353b6a0aed2&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=57bf2c42-87ed-4685-907b-99d18a3e7bd0.37aaf52a-a3c1-4383-a6f9-f353b6a0aed2.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 07:40:40,035 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25547
INFO 2025-08-07 07:40:48,157 views 93565 123145445961728 [SESSION] Final roles for user hr_manager: ['manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:40:48,159 views 93565 123145445961728 [SESSION] Final attrs for user hr_manager: {'department': 'HR', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:40:48,168 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='hr_manager', roles={'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'hr.manager@company.com', 'department': 'HR', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:40:48,168 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:40:48,168 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:40:48,197 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:40:48,202 log 93565 123145445961728 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:40:48,202 basehttp 93565 123145445961728 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:41:02,670 views 93565 123145445961728 [SESSION] Final roles for user hr_manager: ['manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:41:02,671 views 93565 123145445961728 [SESSION] Final attrs for user hr_manager: {'department': 'HR', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:41:02,677 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='hr_manager', roles={'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'hr.manager@company.com', 'department': 'HR', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:41:02,677 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:41:02,677 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:41:02,705 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:41:02,712 log 93565 123145445961728 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-07 07:41:02,715 basehttp 93565 123145445961728 "GET /doc_marketing_001/view/ HTTP/1.1" 403 115
INFO 2025-08-07 07:41:05,351 views 93565 123145445961728 [SESSION] Final roles for user hr_manager: ['manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:41:05,352 views 93565 123145445961728 [SESSION] Final attrs for user hr_manager: {'department': 'HR', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:41:05,358 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='hr_manager', roles={'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'hr.manager@company.com', 'department': 'HR', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:41:05,359 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:41:05,359 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:41:05,371 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:41:05,378 log 93565 123145445961728 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 07:41:05,379 basehttp 93565 123145445961728 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:41:07,312 views 93565 123145445961728 [SESSION] Final roles for user hr_manager: ['manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:41:07,312 views 93565 123145445961728 [SESSION] Final attrs for user hr_manager: {'department': 'HR', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:41:07,325 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='hr_manager', roles={'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'hr.manager@company.com', 'department': 'HR', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:41:07,326 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:41:07,326 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:41:07,341 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:41:07,346 log 93565 123145445961728 Forbidden: /doc_hr_001/view/
WARNING 2025-08-07 07:41:07,346 basehttp 93565 123145445961728 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-07 07:41:11,655 views 93565 123145445961728 [SESSION] Final roles for user hr_manager: ['manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:41:11,655 views 93565 123145445961728 [SESSION] Final attrs for user hr_manager: {'department': 'HR', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:41:11,660 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='hr_manager', roles={'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'hr.manager@company.com', 'department': 'HR', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:41:11,660 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_it_001', kind='document', attr={'author': 'it_admin', 'status': 'rejected', 'department': 'IT', 'classification': 'confidential', 'project_budget': 25000, 'content_type': 'security_policy', 'created_at': '2025-01-04', 'title': 'Security Policy', 'is_financial': False, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:41:11,660 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:41:11,670 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:41:11,675 log 93565 123145445961728 Forbidden: /doc_it_001/view/
WARNING 2025-08-07 07:41:11,676 basehttp 93565 123145445961728 "GET /doc_it_001/view/ HTTP/1.1" 403 107
INFO 2025-08-07 07:41:14,643 views 93565 123145445961728 [SESSION] Final roles for user hr_manager: ['manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:41:14,644 views 93565 123145445961728 [SESSION] Final attrs for user hr_manager: {'department': 'HR', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:41:14,657 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='hr_manager', roles={'manage-account', 'manage-account-links', 'view-profile'}, attr={'email': 'hr.manager@company.com', 'department': 'HR', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:41:14,658 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_finance_002', kind='document', attr={'author': 'john_finance', 'status': 'pending_review', 'department': 'Finance', 'classification': 'restricted', 'project_budget': 5000, 'content_type': 'expense_report', 'created_at': '2025-01-06', 'title': 'Expense Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:41:14,659 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:41:14,675 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:41:14,680 log 93565 123145445961728 Forbidden: /doc_finance_002/view/
WARNING 2025-08-07 07:41:14,695 basehttp 93565 123145445961728 "GET /doc_finance_002/view/ HTTP/1.1" 403 106
INFO 2025-08-07 07:41:21,542 basehttp 93565 123145445961728 "GET /accounts/logout/ HTTP/1.1" 200 2178
INFO 2025-08-07 07:41:23,761 basehttp 93565 123145445961728 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 07:41:23,769 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 07:41:25,256 basehttp 93565 123145445961728 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 07:41:40,096 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 07:41:46,245 basehttp 93565 123145445961728 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 07:41:46,397 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/callback/?state=wmz8lpZVr6QwAWIX&session_state=37aaf52a-a3c1-4383-a6f9-f353b6a0aed2&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=c8b04606-fd60-4682-a4bd-f490f56be9e3.37aaf52a-a3c1-4383-a6f9-f353b6a0aed2.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 07:41:46,421 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25547
INFO 2025-08-07 07:41:48,225 basehttp 93565 123145445961728 "GET /accounts/logout/ HTTP/1.1" 200 2178
INFO 2025-08-07 07:41:49,021 basehttp 93565 123145445961728 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 07:41:49,026 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 07:41:49,793 basehttp 93565 123145445961728 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 07:41:50,960 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 07:41:52,127 basehttp 93565 123145445961728 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 07:41:52,325 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/callback/?state=2xqjVVTWox292rea&session_state=37aaf52a-a3c1-4383-a6f9-f353b6a0aed2&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=d25bc224-9096-465d-b7b9-c03e4cf3b8fa.37aaf52a-a3c1-4383-a6f9-f353b6a0aed2.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 07:41:52,353 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25547
INFO 2025-08-07 07:41:59,984 basehttp 93565 123145445961728 "GET /accounts/logout/ HTTP/1.1" 200 1951
INFO 2025-08-07 07:42:00,810 basehttp 93565 123145445961728 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 07:42:00,816 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 07:42:01,611 basehttp 93565 123145445961728 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 07:42:02,884 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 07:42:04,071 basehttp 93565 123145445961728 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 07:42:04,207 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/callback/?state=axycbEmzV45FrjcI&session_state=37aaf52a-a3c1-4383-a6f9-f353b6a0aed2&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=89341fcd-55e4-4157-99e3-c446ae0dd317.37aaf52a-a3c1-4383-a6f9-f353b6a0aed2.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 07:42:04,224 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25547
INFO 2025-08-07 07:42:17,906 basehttp 93565 123145445961728 "GET /accounts/logout/ HTTP/1.1" 200 2178
INFO 2025-08-07 07:42:18,995 basehttp 93565 123145445961728 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 07:42:19,003 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 07:42:19,724 basehttp 93565 123145445961728 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 07:42:21,117 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 07:42:22,061 basehttp 93565 123145445961728 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 07:42:29,516 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/callback/?state=oDaT7zHdY0RZHX7f&session_state=72ae165b-46d3-4af9-a9fa-1e827cfe44df&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=82db98b9-a468-4878-b195-ce43a0a6482d.72ae165b-46d3-4af9-a9fa-1e827cfe44df.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 07:42:29,533 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25745
INFO 2025-08-07 07:42:35,373 views 93565 123145445961728 [SESSION] Final roles for user project_manager: ['reviewer', 'manage-account', 'view-profile', 'manager', 'manage-account-links']
INFO 2025-08-07 07:42:35,374 views 93565 123145445961728 [SESSION] Final attrs for user project_manager: {'department': 'General', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:42:35,382 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='project_manager', roles={'reviewer', 'manage-account', 'view-profile', 'manage-account-links', 'manager'}, attr={'email': 'project.manager@company.com', 'department': 'General', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:42:35,382 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:42:35,382 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:42:35,405 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 07:42:35,418 basehttp 93565 123145445961728 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 07:43:04,859 views 93565 123145445961728 [SESSION] Final roles for user project_manager: ['reviewer', 'manage-account', 'view-profile', 'manager', 'manage-account-links']
INFO 2025-08-07 07:43:04,860 views 93565 123145445961728 [SESSION] Final attrs for user project_manager: {'department': 'General', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:43:04,922 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='project_manager', roles={'reviewer', 'manage-account', 'view-profile', 'manage-account-links', 'manager'}, attr={'email': 'project.manager@company.com', 'department': 'General', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:43:04,924 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:43:04,924 views 93565 123145445961728 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 07:43:04,982 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 07:43:04,991 basehttp 93565 123145445961728 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 07:43:07,560 views 93565 123145445961728 [SESSION] Final roles for user project_manager: ['reviewer', 'manage-account', 'view-profile', 'manager', 'manage-account-links']
INFO 2025-08-07 07:43:07,561 views 93565 123145445961728 [SESSION] Final attrs for user project_manager: {'department': 'General', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:43:07,568 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='project_manager', roles={'reviewer', 'manage-account', 'view-profile', 'manage-account-links', 'manager'}, attr={'email': 'project.manager@company.com', 'department': 'General', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:43:07,569 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:43:07,569 views 93565 123145445961728 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 07:43:07,579 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 07:43:07,585 basehttp 93565 123145445961728 "GET /doc_hr_001/edit/ HTTP/1.1" 200 2102
INFO 2025-08-07 07:51:29,110 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25745
INFO 2025-08-07 07:51:31,876 views 93565 123145445961728 [SESSION] Final roles for user project_manager: ['reviewer', 'manage-account', 'view-profile', 'manager', 'manage-account-links']
INFO 2025-08-07 07:51:31,876 views 93565 123145445961728 [SESSION] Final attrs for user project_manager: {'department': 'General', 'seniority_level': 'senior', 'project_access_level': None}
INFO 2025-08-07 07:51:31,885 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='project_manager', roles={'reviewer', 'manage-account', 'view-profile', 'manage-account-links', 'manager'}, attr={'email': 'project.manager@company.com', 'department': 'General', 'seniority_level': 'senior', 'project_access_level': 'empty'}, policy_version='default', scope='')
INFO 2025-08-07 07:51:31,886 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:51:31,886 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:51:31,920 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 07:51:31,940 basehttp 93565 123145445961728 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 07:51:36,271 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 25745
INFO 2025-08-07 07:51:44,880 basehttp 93565 123145445961728 "GET /accounts/logout/ HTTP/1.1" 200 2183
INFO 2025-08-07 07:51:45,796 basehttp 93565 123145445961728 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 07:51:45,804 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 07:51:46,679 basehttp 93565 123145445961728 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 07:51:47,689 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 07:51:49,129 basehttp 93565 123145445961728 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 07:51:56,104 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/callback/?state=NC0WZqXhNnF68NuG&session_state=798e1abe-1bcb-4172-b485-8bf4e3427466&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=f4b7f6e8-d61f-4453-a7a6-d90a0ea29bdc.798e1abe-1bcb-4172-b485-8bf4e3427466.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 07:51:56,227 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25636
INFO 2025-08-07 07:52:02,756 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:52:02,756 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 07:52:02,776 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 07:52:02,776 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:52:02,776 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:52:02,864 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:52:02,921 log 93565 123145445961728 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:52:02,929 basehttp 93565 123145445961728 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:52:28,147 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:52:28,148 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 07:52:28,157 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 07:52:28,157 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:52:28,157 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:52:28,172 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:52:28,177 log 93565 123145445961728 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-07 07:52:28,178 basehttp 93565 123145445961728 "GET /doc_marketing_001/view/ HTTP/1.1" 403 115
INFO 2025-08-07 07:52:30,100 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:52:30,105 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 07:52:30,109 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 07:52:30,109 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:52:30,110 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:52:30,124 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:52:30,131 log 93565 123145445961728 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 07:52:30,132 basehttp 93565 123145445961728 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:52:32,446 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:52:32,447 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 07:52:32,449 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 07:52:32,450 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:52:32,450 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:52:32,478 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:52:32,483 log 93565 123145445961728 Forbidden: /doc_hr_001/view/
WARNING 2025-08-07 07:52:32,490 basehttp 93565 123145445961728 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-07 07:52:34,547 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:52:34,547 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 07:52:34,596 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 07:52:34,596 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_it_001', kind='document', attr={'author': 'it_admin', 'status': 'rejected', 'department': 'IT', 'classification': 'confidential', 'project_budget': 25000, 'content_type': 'security_policy', 'created_at': '2025-01-04', 'title': 'Security Policy', 'is_financial': False, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 07:52:34,597 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:52:34,611 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:52:34,620 log 93565 123145445961728 Forbidden: /doc_it_001/view/
WARNING 2025-08-07 07:52:34,621 basehttp 93565 123145445961728 "GET /doc_it_001/view/ HTTP/1.1" 403 107
INFO 2025-08-07 07:52:36,371 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:52:36,371 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 07:52:36,375 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 07:52:36,375 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:52:36,375 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:52:36,382 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:52:36,388 log 93565 123145445961728 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:52:36,389 basehttp 93565 123145445961728 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 07:52:38,546 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:52:38,546 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 07:52:38,549 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 07:52:38,550 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_finance_002', kind='document', attr={'author': 'john_finance', 'status': 'pending_review', 'department': 'Finance', 'classification': 'restricted', 'project_budget': 5000, 'content_type': 'expense_report', 'created_at': '2025-01-06', 'title': 'Expense Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:52:38,550 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:52:38,565 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:52:38,573 log 93565 123145445961728 Forbidden: /doc_finance_002/view/
WARNING 2025-08-07 07:52:38,574 basehttp 93565 123145445961728 "GET /doc_finance_002/view/ HTTP/1.1" 403 106
INFO 2025-08-07 07:53:49,780 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 07:53:49,783 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 07:53:49,788 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 07:53:49,789 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 07:53:49,789 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 07:53:49,836 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 07:53:49,851 log 93565 123145445961728 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 07:53:49,852 basehttp 93565 123145445961728 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
WARNING 2025-08-07 07:55:49,835 log 93565 123145445961728 Not Found: /.well-known/appspecific/com.chrome.devtools.json
WARNING 2025-08-07 07:55:49,874 basehttp 93565 123145445961728 "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 2830
INFO 2025-08-07 07:57:52,063 basehttp 93565 123145445961728 "GET /accounts/logout/ HTTP/1.1" 200 2179
INFO 2025-08-07 07:57:55,340 basehttp 93565 123145445961728 "GET /accounts/logout/ HTTP/1.1" 200 1951
INFO 2025-08-07 07:57:56,147 basehttp 93565 123145445961728 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 07:57:56,154 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 07:57:57,051 basehttp 93565 123145445961728 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 07:57:58,416 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 07:57:59,399 basehttp 93565 123145445961728 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 07:57:59,688 basehttp 93565 123145445961728 "GET /accounts/oidc/keycloak/login/callback/?state=5KG7xA84xX0VkVW4&session_state=798e1abe-1bcb-4172-b485-8bf4e3427466&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=49c4473a-e0fa-4588-8ff7-9baa8f37612c.798e1abe-1bcb-4172-b485-8bf4e3427466.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 07:57:59,707 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25636
INFO 2025-08-07 09:03:25,924 basehttp 93565 123145445961728 "GET /documents/ HTTP/1.1" 200 25636
INFO 2025-08-07 09:03:28,302 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:03:28,303 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 09:03:28,318 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:03:28,320 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:03:28,320 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:03:29,501 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:03:29,522 basehttp 93565 123145445961728 "GET /doc_marketing_002/view/ HTTP/1.1" 200 1463
INFO 2025-08-07 09:03:33,928 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 25636
INFO 2025-08-07 09:03:36,939 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:03:36,939 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 09:03:36,951 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:03:36,951 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:03:36,951 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:03:36,991 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:03:37,001 log 93565 123145445961728 Forbidden: /doc_marketing_001/view/
WARNING 2025-08-07 09:03:37,002 basehttp 93565 123145445961728 "GET /doc_marketing_001/view/ HTTP/1.1" 403 115
INFO 2025-08-07 09:03:39,445 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:03:39,445 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 09:03:39,452 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:03:39,452 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:03:39,453 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:03:39,464 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:03:39,472 log 93565 123145445961728 Forbidden: /doc_hr_001/view/
WARNING 2025-08-07 09:03:39,472 basehttp 93565 123145445961728 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-07 09:04:02,352 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:04:02,361 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 09:04:02,382 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:04:02,383 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_finance_002', kind='document', attr={'author': 'john_finance', 'status': 'pending_review', 'department': 'Finance', 'classification': 'restricted', 'project_budget': 5000, 'content_type': 'expense_report', 'created_at': '2025-01-06', 'title': 'Expense Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:04:02,387 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:04:02,505 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:04:02,580 log 93565 123145445961728 Forbidden: /doc_finance_002/view/
WARNING 2025-08-07 09:04:02,583 basehttp 93565 123145445961728 "GET /doc_finance_002/view/ HTTP/1.1" 403 106
INFO 2025-08-07 09:21:01,431 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:21:01,433 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 09:21:01,471 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:21:01,473 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 1500, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:21:01,478 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:21:02,257 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:21:02,284 basehttp 93565 123145445961728 "GET /doc_marketing_002/view/ HTTP/1.1" 200 1463
INFO 2025-08-07 09:35:36,175 basehttp 93565 123145445961728 "GET / HTTP/1.1" 200 25636
INFO 2025-08-07 09:35:37,656 views 93565 123145445961728 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:35:37,656 views 93565 123145445961728 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 09:35:37,671 views 93565 123145445961728 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account-links', 'manage-account', 'user', 'view-profile'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:35:37,671 views 93565 123145445961728 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:35:37,671 views 93565 123145445961728 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:35:37,821 _client 93565 123145445961728 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:35:37,829 log 93565 123145445961728 Forbidden: /doc_hr_001/view/
WARNING 2025-08-07 09:35:37,830 basehttp 93565 123145445961728 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-07 09:35:57,629 autoreload 93565 140704330349056 /Users/duy/Documents/test/django_cerbos_keycloak/documents/data.py changed, reloading.
INFO 2025-08-07 09:36:01,872 autoreload 99531 140704330349056 Watching for file changes with StatReloader
INFO 2025-08-07 09:36:11,205 basehttp 99531 123145543602176 "GET / HTTP/1.1" 200 25636
INFO 2025-08-07 09:36:35,206 basehttp 99531 123145543602176 "GET /accounts/logout/ HTTP/1.1" 200 2179
INFO 2025-08-07 09:36:36,207 basehttp 99531 123145543602176 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 09:36:36,214 basehttp 99531 123145543602176 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 09:36:37,092 basehttp 99531 123145543602176 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 09:36:38,599 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 09:36:40,288 basehttp 99531 123145543602176 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 09:36:48,532 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/callback/?state=aqfQ5rbAv3yLCgc2&session_state=b52ca1f1-2ce3-4eca-abbc-e4dc3614527e&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=d1c1faa6-4acf-4ca3-b34e-2835016b7ba2.b52ca1f1-2ce3-4eca-abbc-e4dc3614527e.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 09:36:48,548 basehttp 99531 123145543602176 "GET /documents/ HTTP/1.1" 200 25636
INFO 2025-08-07 09:36:59,902 views 99531 123145543602176 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:36:59,909 views 99531 123145543602176 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 09:36:59,924 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:36:59,924 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:36:59,924 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:36:59,951 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:36:59,960 log 99531 123145543602176 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 09:36:59,960 basehttp 99531 123145543602176 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 09:37:03,875 views 99531 123145543602176 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:37:03,875 views 99531 123145543602176 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 09:37:03,890 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:37:03,890 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 15000, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:37:03,890 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:37:03,938 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:37:03,942 log 99531 123145543602176 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 09:37:03,942 basehttp 99531 123145543602176 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 09:37:09,034 views 99531 123145543602176 [SESSION] Final roles for user intern_user: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:37:09,035 views 99531 123145543602176 [SESSION] Final attrs for user intern_user: {'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}
INFO 2025-08-07 09:37:09,041 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='intern_user', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'intern@company.com', 'department': 'Marketing', 'seniority_level': 'junior', 'project_access_level': 'assigned_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:37:09,042 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 15000, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:37:09,042 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:37:09,067 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:37:09,072 log 99531 123145543602176 Forbidden: /doc_marketing_002/view/
WARNING 2025-08-07 09:37:09,076 basehttp 99531 123145543602176 "GET /doc_marketing_002/view/ HTTP/1.1" 403 108
INFO 2025-08-07 09:38:19,491 basehttp 99531 123145543602176 "GET /accounts/logout/ HTTP/1.1" 200 2179
INFO 2025-08-07 09:38:21,216 basehttp 99531 123145543602176 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 09:38:21,220 basehttp 99531 123145543602176 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 09:38:35,778 basehttp 99531 123145543602176 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 09:38:37,162 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 09:38:38,224 basehttp 99531 123145543602176 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 09:38:38,529 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/callback/?state=rfW1KfyjkXryjGwt&session_state=b52ca1f1-2ce3-4eca-abbc-e4dc3614527e&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=ff8c0869-eade-4102-958f-fae5b94b61e4.b52ca1f1-2ce3-4eca-abbc-e4dc3614527e.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 09:38:38,553 basehttp 99531 123145543602176 "GET /documents/ HTTP/1.1" 200 25636
INFO 2025-08-07 09:38:41,191 basehttp 99531 123145543602176 "GET /accounts/logout/ HTTP/1.1" 200 2179
INFO 2025-08-07 09:38:52,016 basehttp 99531 123145543602176 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 09:38:52,020 basehttp 99531 123145543602176 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 09:38:53,120 basehttp 99531 123145543602176 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 09:38:54,331 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 09:38:58,295 basehttp 99531 123145543602176 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 09:39:03,781 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/callback/?state=AIEIyc3pHXBZOpOu&session_state=736340c9-115d-4655-8cf0-f24ff1de9465&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=2c292f3a-9b40-426e-9b82-eaa12645f112.736340c9-115d-4655-8cf0-f24ff1de9465.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 09:39:03,795 basehttp 99531 123145543602176 "GET /documents/ HTTP/1.1" 200 25765
INFO 2025-08-07 09:39:18,113 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:39:18,114 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:39:18,120 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:39:18,120 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:39:18,121 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:39:18,190 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:39:18,198 basehttp 99531 123145543602176 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 09:39:20,428 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:39:20,429 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:39:20,437 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:39:20,437 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:39:20,513 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:39:20,534 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:39:20,542 basehttp 99531 123145543602176 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 09:39:27,216 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:39:27,216 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:39:27,222 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:39:27,222 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:39:27,223 views 99531 123145543602176 [CERBOS][CHECK] Action: approve
INFO 2025-08-07 09:39:27,245 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:39:27,250 basehttp 99531 123145543602176 "GET /doc_marketing_001/approve/ HTTP/1.1" 200 1349
INFO 2025-08-07 09:39:28,769 basehttp 99531 123145543602176 "GET / HTTP/1.1" 200 25765
INFO 2025-08-07 09:39:30,269 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:39:30,269 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:39:30,275 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:39:30,276 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:39:30,276 views 99531 123145543602176 [CERBOS][CHECK] Action: reject
INFO 2025-08-07 09:39:30,296 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:39:30,300 basehttp 99531 123145543602176 "GET /doc_marketing_001/reject/ HTTP/1.1" 200 1341
INFO 2025-08-07 09:39:34,982 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:39:34,983 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:39:34,987 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:39:34,987 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:39:35,009 views 99531 123145543602176 [CERBOS][CHECK] Action: delete
INFO 2025-08-07 09:39:35,018 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:39:35,024 log 99531 123145543602176 Forbidden: /doc_marketing_001/delete/
WARNING 2025-08-07 09:39:35,025 basehttp 99531 123145543602176 "GET /doc_marketing_001/delete/ HTTP/1.1" 403 117
INFO 2025-08-07 09:39:43,370 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:39:43,370 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:39:43,378 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:39:43,378 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:39:43,378 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:39:43,388 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:39:43,415 basehttp 99531 123145543602176 "GET /doc_finance_001/view/ HTTP/1.1" 200 1473
INFO 2025-08-07 09:41:42,999 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:41:43,000 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:41:43,006 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:41:43,006 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:41:43,006 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:41:43,043 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:41:43,057 log 99531 123145543602176 Forbidden: /doc_hr_001/edit/
WARNING 2025-08-07 09:41:43,058 basehttp 99531 123145543602176 "GET /doc_hr_001/edit/ HTTP/1.1" 403 109
INFO 2025-08-07 09:41:55,659 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:41:55,664 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:41:55,676 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:41:55,677 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:41:55,681 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:41:55,706 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:41:55,722 log 99531 123145543602176 Forbidden: /doc_finance_001/edit/
WARNING 2025-08-07 09:41:55,723 basehttp 99531 123145543602176 "GET /doc_finance_001/edit/ HTTP/1.1" 403 108
INFO 2025-08-07 09:42:20,003 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:42:20,004 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:42:20,012 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:42:20,013 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:42:20,013 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:42:20,028 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:42:20,037 basehttp 99531 123145543602176 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 09:42:26,027 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:42:26,063 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:42:26,072 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:42:26,072 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:42:26,072 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:42:26,091 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:42:26,101 basehttp 99531 123145543602176 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 09:42:28,704 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:42:28,704 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:42:28,708 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:42:28,708 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:42:28,708 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:42:28,722 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:42:28,726 log 99531 123145543602176 Forbidden: /doc_finance_001/edit/
WARNING 2025-08-07 09:42:28,726 basehttp 99531 123145543602176 "GET /doc_finance_001/edit/ HTTP/1.1" 403 108
INFO 2025-08-07 09:42:30,642 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:42:30,642 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:42:30,790 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:42:30,791 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:42:30,792 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:42:30,819 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:42:30,848 log 99531 123145543602176 Forbidden: /doc_hr_001/edit/
WARNING 2025-08-07 09:42:30,852 basehttp 99531 123145543602176 "GET /doc_hr_001/edit/ HTTP/1.1" 403 109
INFO 2025-08-07 09:42:32,888 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:42:32,888 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:42:32,892 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:42:32,892 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_it_001', kind='document', attr={'author': 'it_admin', 'status': 'rejected', 'department': 'IT', 'classification': 'confidential', 'project_budget': 25000, 'content_type': 'security_policy', 'created_at': '2025-01-04', 'title': 'Security Policy', 'is_financial': False, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:42:32,892 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:42:32,919 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:42:32,925 basehttp 99531 123145543602176 "GET /doc_it_001/edit/ HTTP/1.1" 200 2106
INFO 2025-08-07 09:42:36,275 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:42:36,275 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:42:36,285 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:42:36,286 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 15000, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:42:36,286 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:42:36,300 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:42:36,305 log 99531 123145543602176 Forbidden: /doc_marketing_002/edit/
WARNING 2025-08-07 09:42:36,306 basehttp 99531 123145543602176 "GET /doc_marketing_002/edit/ HTTP/1.1" 403 108
INFO 2025-08-07 09:42:38,073 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:42:38,074 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:42:38,083 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:42:38,084 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_002', kind='document', attr={'author': 'john_finance', 'status': 'pending_review', 'department': 'Finance', 'classification': 'restricted', 'project_budget': 5000, 'content_type': 'expense_report', 'created_at': '2025-01-06', 'title': 'Expense Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:42:38,084 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:42:38,149 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:42:38,156 log 99531 123145543602176 Forbidden: /doc_finance_002/edit/
WARNING 2025-08-07 09:42:38,157 basehttp 99531 123145543602176 "GET /doc_finance_002/edit/ HTTP/1.1" 403 106
INFO 2025-08-07 09:42:47,604 views 99531 123145543602176 [SESSION] Final roles for user security_auditor: ['manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer']
INFO 2025-08-07 09:42:47,604 views 99531 123145543602176 [SESSION] Final attrs for user security_auditor: {'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}
INFO 2025-08-07 09:42:47,609 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='security_auditor', roles={'manage-account', 'view-profile', 'reviewer', 'manage-account-links', 'security_officer'}, attr={'email': 'security.auditor@company.com', 'department': 'Security', 'seniority_level': 'senior', 'project_access_level': 'all_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:42:47,609 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:42:47,609 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:42:47,631 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:42:47,637 basehttp 99531 123145543602176 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 09:54:02,790 basehttp 99531 123145543602176 "GET /accounts/logout/ HTTP/1.1" 200 2184
INFO 2025-08-07 09:54:03,902 basehttp 99531 123145543602176 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 09:54:03,910 basehttp 99531 123145543602176 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 09:54:04,851 basehttp 99531 123145543602176 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 09:54:05,822 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 09:54:06,955 basehttp 99531 123145543602176 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 09:54:07,267 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/callback/?state=2tRUxRuHtRkwBWwD&session_state=736340c9-115d-4655-8cf0-f24ff1de9465&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=07a74d1e-3add-4243-890e-2406386fe440.736340c9-115d-4655-8cf0-f24ff1de9465.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 09:54:07,284 basehttp 99531 123145543602176 "GET /documents/ HTTP/1.1" 200 25765
INFO 2025-08-07 09:54:24,026 basehttp 99531 123145543602176 "GET /accounts/logout/ HTTP/1.1" 200 2184
INFO 2025-08-07 09:54:25,110 basehttp 99531 123145543602176 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 09:54:25,312 basehttp 99531 123145543602176 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 09:54:26,132 basehttp 99531 123145543602176 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 09:54:27,429 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 09:54:28,493 basehttp 99531 123145543602176 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 09:54:34,044 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/callback/?state=VamxL70Em3cwtTDV&session_state=eabe8258-e4ea-4637-9d10-b0658af3da38&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=1cf342a3-756d-41dd-8aa3-0cdf5ec6ae48.eabe8258-e4ea-4637-9d10-b0658af3da38.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 09:54:34,066 basehttp 99531 123145543602176 "GET /documents/ HTTP/1.1" 200 25719
INFO 2025-08-07 09:54:43,622 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'admin', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:54:43,623 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:54:43,642 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'user', 'manage-account', 'admin', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:54:43,642 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:54:43,643 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:54:43,745 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:54:43,759 basehttp 99531 123145543602176 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 09:54:45,866 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'admin', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:54:45,867 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:54:45,874 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'user', 'manage-account', 'admin', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:54:45,874 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:54:45,875 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:54:45,893 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:54:45,903 basehttp 99531 123145543602176 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 09:54:47,782 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'admin', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:54:47,782 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:54:47,787 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'user', 'manage-account', 'admin', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:54:47,787 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:54:47,805 views 99531 123145543602176 [CERBOS][CHECK] Action: approve
INFO 2025-08-07 09:54:47,823 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:54:47,832 basehttp 99531 123145543602176 "GET /doc_marketing_001/approve/ HTTP/1.1" 200 1341
INFO 2025-08-07 09:54:53,274 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'admin', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:54:53,275 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:54:53,280 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'user', 'manage-account', 'admin', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:54:53,280 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:54:53,280 views 99531 123145543602176 [CERBOS][CHECK] Action: reject
INFO 2025-08-07 09:54:53,289 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:54:53,314 basehttp 99531 123145543602176 "GET /doc_marketing_001/reject/ HTTP/1.1" 200 1333
INFO 2025-08-07 09:54:55,321 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'admin', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:54:55,321 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:54:55,331 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'user', 'manage-account', 'admin', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:54:55,331 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:54:55,331 views 99531 123145543602176 [CERBOS][CHECK] Action: delete
INFO 2025-08-07 09:54:55,337 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:54:55,367 basehttp 99531 123145543602176 "GET /doc_marketing_001/delete/ HTTP/1.1" 200 841
INFO 2025-08-07 09:54:58,603 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'admin', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:54:58,603 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:54:58,609 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'user', 'manage-account', 'admin', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:54:58,610 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:54:58,610 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:54:58,629 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:54:58,637 basehttp 99531 123145543602176 "GET /doc_finance_001/view/ HTTP/1.1" 200 1473
INFO 2025-08-07 09:55:02,101 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'admin', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:55:02,101 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:55:02,104 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'user', 'manage-account', 'admin', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:55:02,104 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:55:02,109 views 99531 123145543602176 [CERBOS][CHECK] Action: approve
INFO 2025-08-07 09:55:02,126 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:55:02,134 basehttp 99531 123145543602176 "GET /doc_finance_001/approve/ HTTP/1.1" 200 1324
INFO 2025-08-07 09:55:04,204 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'admin', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:55:04,204 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:55:04,208 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'user', 'manage-account', 'admin', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:55:04,208 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:55:04,209 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:55:04,227 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:55:04,237 basehttp 99531 123145543602176 "GET /doc_hr_001/view/ HTTP/1.1" 200 1458
INFO 2025-08-07 09:55:05,979 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'admin', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:55:05,981 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:55:05,986 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'user', 'manage-account', 'admin', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:55:05,986 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_it_001', kind='document', attr={'author': 'it_admin', 'status': 'rejected', 'department': 'IT', 'classification': 'confidential', 'project_budget': 25000, 'content_type': 'security_policy', 'created_at': '2025-01-04', 'title': 'Security Policy', 'is_financial': False, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:55:06,011 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:55:06,048 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:55:06,056 basehttp 99531 123145543602176 "GET /doc_it_001/view/ HTTP/1.1" 200 1459
INFO 2025-08-07 09:55:43,005 basehttp 99531 123145543602176 "GET /accounts/logout/ HTTP/1.1" 200 2176
INFO 2025-08-07 09:55:43,972 basehttp 99531 123145543602176 "POST /accounts/logout/ HTTP/1.1" 302 0
INFO 2025-08-07 09:55:43,999 basehttp 99531 123145543602176 "GET / HTTP/1.1" 200 10137
INFO 2025-08-07 09:55:44,801 basehttp 99531 123145543602176 "GET /accounts/login/ HTTP/1.1" 200 2706
INFO 2025-08-07 09:55:46,457 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 200 1416
INFO 2025-08-07 09:55:47,433 basehttp 99531 123145543602176 "POST /accounts/oidc/keycloak/login/?process=login HTTP/1.1" 302 0
INFO 2025-08-07 09:55:53,702 basehttp 99531 123145543602176 "GET /accounts/oidc/keycloak/login/callback/?state=eNivDJr81G1CYNry&session_state=34395a6a-57f8-4a69-81b8-556be380f29a&iss=http%3A%2F%2Flocalhost%3A8080%2Frealms%2Fdjango-app&code=be79a58d-7768-451f-96d8-387fff9fd968.34395a6a-57f8-4a69-81b8-556be380f29a.1cba6675-1ac7-48fd-a7c6-67cc801a8630 HTTP/1.1" 302 0
INFO 2025-08-07 09:55:53,721 basehttp 99531 123145543602176 "GET /documents/ HTTP/1.1" 200 25630
INFO 2025-08-07 09:55:57,201 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:55:57,205 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:55:57,213 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:55:57,215 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:55:57,367 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:55:57,393 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:55:57,399 basehttp 99531 123145543602176 "GET /doc_marketing_001/edit/ HTTP/1.1" 200 2130
INFO 2025-08-07 09:55:59,339 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:55:59,339 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:55:59,349 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:55:59,350 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:55:59,369 views 99531 123145543602176 [CERBOS][CHECK] Action: approve
INFO 2025-08-07 09:55:59,401 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:55:59,412 log 99531 123145543602176 Forbidden: /doc_marketing_001/approve/
WARNING 2025-08-07 09:55:59,414 basehttp 99531 123145543602176 "GET /doc_marketing_001/approve/ HTTP/1.1" 403 114
INFO 2025-08-07 09:56:07,543 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:56:07,543 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:56:07,552 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:56:07,552 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:56:07,560 views 99531 123145543602176 [CERBOS][CHECK] Action: reject
INFO 2025-08-07 09:56:07,572 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:56:07,584 log 99531 123145543602176 Forbidden: /doc_marketing_001/reject/
WARNING 2025-08-07 09:56:07,584 basehttp 99531 123145543602176 "GET /doc_marketing_001/reject/ HTTP/1.1" 403 117
INFO 2025-08-07 09:56:09,286 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:56:09,287 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:56:09,292 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:56:09,292 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:56:09,309 views 99531 123145543602176 [CERBOS][CHECK] Action: delete
INFO 2025-08-07 09:56:09,320 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:56:09,324 log 99531 123145543602176 Forbidden: /doc_marketing_001/delete/
WARNING 2025-08-07 09:56:09,325 basehttp 99531 123145543602176 "GET /doc_marketing_001/delete/ HTTP/1.1" 403 117
INFO 2025-08-07 09:56:10,787 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:56:10,787 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:56:10,794 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:56:10,795 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:56:10,810 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:56:10,830 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:56:10,835 log 99531 123145543602176 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 09:56:10,835 basehttp 99531 123145543602176 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 09:56:12,804 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:56:12,804 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:56:12,821 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:56:12,822 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:56:12,822 views 99531 123145543602176 [CERBOS][CHECK] Action: approve
INFO 2025-08-07 09:56:12,855 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:56:12,875 log 99531 123145543602176 Forbidden: /doc_finance_001/approve/
WARNING 2025-08-07 09:56:12,876 basehttp 99531 123145543602176 "GET /doc_finance_001/approve/ HTTP/1.1" 403 107
INFO 2025-08-07 09:56:14,708 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:56:14,709 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:56:14,719 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:56:14,719 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_it_001', kind='document', attr={'author': 'it_admin', 'status': 'rejected', 'department': 'IT', 'classification': 'confidential', 'project_budget': 25000, 'content_type': 'security_policy', 'created_at': '2025-01-04', 'title': 'Security Policy', 'is_financial': False, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:56:14,719 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:56:14,734 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:56:14,738 log 99531 123145543602176 Forbidden: /doc_it_001/view/
WARNING 2025-08-07 09:56:14,738 basehttp 99531 123145543602176 "GET /doc_it_001/view/ HTTP/1.1" 403 107
INFO 2025-08-07 09:56:16,458 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:56:16,458 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:56:16,470 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:56:16,471 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_002', kind='document', attr={'author': 'jane_smith', 'status': 'approved', 'department': 'Marketing', 'classification': 'public', 'project_budget': 15000, 'content_type': 'brand_document', 'created_at': '2025-01-05', 'title': 'Brand Guidelines', 'is_financial': False, 'is_sensitive': False, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:56:16,471 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:56:16,485 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:56:16,489 basehttp 99531 123145543602176 "GET /doc_marketing_002/view/ HTTP/1.1" 200 1464
INFO 2025-08-07 09:56:18,700 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:56:18,700 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:56:18,709 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:56:18,709 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_002', kind='document', attr={'author': 'john_finance', 'status': 'pending_review', 'department': 'Finance', 'classification': 'restricted', 'project_budget': 5000, 'content_type': 'expense_report', 'created_at': '2025-01-06', 'title': 'Expense Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:56:18,710 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:56:18,733 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:56:18,738 log 99531 123145543602176 Forbidden: /doc_finance_002/view/
WARNING 2025-08-07 09:56:18,739 basehttp 99531 123145543602176 "GET /doc_finance_002/view/ HTTP/1.1" 403 106
INFO 2025-08-07 09:56:22,267 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:56:22,267 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:56:22,276 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:56:22,277 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 09:56:22,277 views 99531 123145543602176 [CERBOS][CHECK] Action: edit
INFO 2025-08-07 09:56:22,287 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 09:56:22,314 log 99531 123145543602176 Forbidden: /doc_hr_001/edit/
WARNING 2025-08-07 09:56:22,315 basehttp 99531 123145543602176 "GET /doc_hr_001/edit/ HTTP/1.1" 403 109
INFO 2025-08-07 09:56:35,786 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 09:56:35,786 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 09:56:35,818 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 09:56:35,818 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 09:56:35,818 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 09:56:35,837 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 09:56:35,844 basehttp 99531 123145543602176 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
WARNING 2025-08-07 10:01:31,997 log 99531 123145543602176 Forbidden: /api/cerbos-log/
WARNING 2025-08-07 10:01:32,000 basehttp 99531 123145543602176 "GET /api/cerbos-log/ HTTP/1.1" 403 19
INFO 2025-08-07 10:08:15,994 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:08:15,995 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:08:16,007 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:08:16,007 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:08:16,007 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:08:16,091 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 10:08:16,126 log 99531 123145543602176 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 10:08:16,129 basehttp 99531 123145543602176 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 10:10:33,262 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:10:33,263 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:10:33,269 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:10:33,269 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:10:33,269 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:10:33,344 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 10:10:33,360 basehttp 99531 123145543602176 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 10:10:36,633 basehttp 99531 123145543602176 "GET / HTTP/1.1" 200 25630
INFO 2025-08-07 10:10:38,650 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:10:38,650 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:10:38,661 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:10:38,661 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:10:38,661 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:10:38,679 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 10:10:38,693 log 99531 123145543602176 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 10:10:38,694 basehttp 99531 123145543602176 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 10:13:04,393 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:13:04,404 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:13:04,414 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:13:04,414 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 10:13:04,415 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:13:04,508 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 10:13:04,516 log 99531 123145543602176 Forbidden: /doc_hr_001/view/
WARNING 2025-08-07 10:13:04,517 basehttp 99531 123145543602176 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-07 10:17:53,344 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:17:53,346 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:17:53,350 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:17:53,350 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 10:17:53,351 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:17:53,369 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 10:17:53,377 log 99531 123145543602176 Forbidden: /doc_hr_001/view/
WARNING 2025-08-07 10:17:53,377 basehttp 99531 123145543602176 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-07 10:17:56,248 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:17:56,249 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:17:56,255 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:17:56,255 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:17:56,256 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:17:56,363 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 10:17:56,383 basehttp 99531 123145543602176 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 10:21:34,006 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:21:34,008 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:21:34,014 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:21:34,015 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:21:34,015 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:21:34,055 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 10:21:34,066 log 99531 123145543602176 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 10:21:34,072 basehttp 99531 123145543602176 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 10:23:02,473 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:23:02,475 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:23:02,479 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:23:02,479 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:23:02,479 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:23:02,501 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 10:23:02,509 log 99531 123145543602176 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 10:23:02,510 basehttp 99531 123145543602176 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 10:23:38,306 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:23:38,307 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:23:38,345 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:23:38,346 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:23:38,346 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:23:38,378 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 10:23:38,390 basehttp 99531 123145543602176 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 10:24:40,665 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:24:40,667 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:24:40,679 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:24:40,680 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_hr_001', kind='document', attr={'author': 'hr_manager', 'status': 'draft', 'department': 'HR', 'classification': 'internal', 'project_budget': 10000, 'content_type': 'policy_document', 'created_at': '2025-01-03', 'title': 'Employee Handbook', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': False}, policy_version='default', scope='')
INFO 2025-08-07 10:24:40,680 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:24:40,719 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 10:24:40,733 log 99531 123145543602176 Forbidden: /doc_hr_001/view/
WARNING 2025-08-07 10:24:40,734 basehttp 99531 123145543602176 "GET /doc_hr_001/view/ HTTP/1.1" 403 109
INFO 2025-08-07 10:24:49,399 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:24:49,400 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:24:49,410 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:24:49,411 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:24:49,411 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:24:49,426 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 10:24:49,436 basehttp 99531 123145543602176 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
INFO 2025-08-07 10:25:05,818 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:25:05,819 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:25:05,860 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:25:05,862 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_finance_001', kind='document', attr={'author': 'finance_user', 'status': 'approved', 'department': 'Finance', 'classification': 'confidential', 'project_budget': 1000000, 'content_type': 'financial_report', 'created_at': '2025-01-02', 'title': 'Q4 Budget Report', 'is_financial': True, 'is_sensitive': True, 'requires_approval': False, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:25:05,862 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:25:05,883 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
WARNING 2025-08-07 10:25:05,890 log 99531 123145543602176 Forbidden: /doc_finance_001/view/
WARNING 2025-08-07 10:25:05,891 basehttp 99531 123145543602176 "GET /doc_finance_001/view/ HTTP/1.1" 403 108
INFO 2025-08-07 10:26:43,243 views 99531 123145543602176 [SESSION] Final roles for user john_doe: ['user', 'manage-account', 'view-profile', 'manage-account-links']
INFO 2025-08-07 10:26:43,244 views 99531 123145543602176 [SESSION] Final attrs for user john_doe: {'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}
INFO 2025-08-07 10:26:43,251 views 99531 123145543602176 [CERBOS][CHECK] Principal: Principal(id='john_doe', roles={'manage-account', 'user', 'view-profile', 'manage-account-links'}, attr={'email': 'john@example.com', 'department': 'Marketing', 'seniority_level': 'mid', 'project_access_level': 'department_projects'}, policy_version='default', scope='')
INFO 2025-08-07 10:26:43,251 views 99531 123145543602176 [CERBOS][CHECK] Resource: Resource(id='doc_marketing_001', kind='document', attr={'author': 'john_doe', 'status': 'pending_approval', 'department': 'Marketing', 'classification': 'internal', 'project_budget': 50000, 'content_type': 'campaign_plan', 'created_at': '2025-01-01', 'title': 'Marketing Campaign Plan', 'is_financial': False, 'is_sensitive': False, 'requires_approval': True, 'is_high_value': True}, policy_version='default', scope='')
INFO 2025-08-07 10:26:43,251 views 99531 123145543602176 [CERBOS][CHECK] Action: view
INFO 2025-08-07 10:26:43,265 _client 99531 123145543602176 HTTP Request: POST http://localhost:3592/api/check/resources "HTTP/1.1 200 OK"
INFO 2025-08-07 10:26:43,279 basehttp 99531 123145543602176 "GET /doc_marketing_001/view/ HTTP/1.1" 200 1486
