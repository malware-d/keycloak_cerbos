# ========================================
# security_auditor.yaml - FIXED
# ========================================
apiVersion: api.cerbos.dev/v1
principalPolicy:
  version: default
  principal: "security_auditor"
  rules:
    - resource: document
      actions:
        # Read-only access to all documents for auditing purposes
        - action: "view"
          effect: EFFECT_ALLOW
          name: security_auditor_view_all

        # Can approve security policies
        - action: "approve"
          effect: EFFECT_ALLOW
          condition:
            match:
              expr: request.resource.attr.content_type == 'security_policy'
          name: security_auditor_approve_security

        # Can approve compliance documents
        - action: "approve"
          effect: EFFECT_ALLOW
          condition:
            match:
              expr: request.resource.attr.content_type == 'compliance_document'
          name: security_auditor_approve_compliance

        # Can reject any document that violates security policies
        - action: "reject"
          effect: EFFECT_ALLOW
          condition:
            match:
              expr: request.resource.attr.classification in ['confidential', 'restricted']
          name: security_auditor_reject_violations